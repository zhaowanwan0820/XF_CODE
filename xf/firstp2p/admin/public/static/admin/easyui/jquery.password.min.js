(function(e){var t={init:function(t){var n=e.extend({minLength:8,allowSpace:false,change:function(){},strengthIndicator:null,personalInformation:[],checklist:null,dictionary:null,doubleType:null},t);this.each(function(){var t=e(this);var r=null;var i=null;var s=null;e.each(n.personalInformation,function(t,r){if(typeof r=="string"){if(e(r).length>0){n.personalInformation[t]=e(r)}}});var o=e.fn.password("calculateScore",t,n);if(n.strengthIndicator!=null){if(typeof n.strengthIndicator=="string"){r=e(n.strengthIndicator)}else{r=n.strengthIndicator}r.html('<div class="pw_strengthIndicator"><div class="strength weak">&nbsp;弱&nbsp;</div><div class="strength medium">中等&nbsp;</div><div class="strength strong">&nbsp;强&nbsp;</div></div>');if(o[2]){r.find(".weak").addClass("pass");if(o[0]>=50){r.find(".medium").addClass("pass")}if(o[0]>=80){r.find(".strong").addClass("pass")}}}if(n.doubleType!=null){if(typeof n.doubleType=="string"){s=e(n.doubleType)}else{s=n.doubleType}s.keyup(function(){if(i!=null){i.find(".pw_check_match").removeClass("pass");if(t.val()==s.val()){i.find(".pw_check_match").addClass("pass")}}})}if(n.checklist!=null){if(typeof n.checklist=="string"){i=e(n.checklist)}else{i=n.checklist}i.html('<div class="pw_checklist"><ul><li class="pw_check_length">Length of at least '+n.minLength+' characters</li><li class="pw_check_uclc">Contains uppercase and lowercase letters</li><li class="pw_check_nums">Contains numbers</li><li class="pw_check_special">Contains special characters</li><li class="pw_check_spaces">Doesn\'t contain spaces</li><li class="pw_check_personal">Doesn\'t contain personal information</li><li class="pw_check_dictionary">Doesn\'t contain common password words</li><li class="pw_check_match">Passwords match</li></ul></div>');if(n.personalInformation.length==0){i.find(".pw_check_personal").remove()}if(n.allowSpace){i.find(".pw_check_spaces").remove()}if(n.minLength<1){i.find(".pw_check_length").remove()}if(n.dictionary==null){i.find(".pw_check_dictionary").remove()}if(s==null){i.find(".pw_check_match").remove()}if(o[1].indexOf("TOO_SHORT")==-1){i.find(".pw_check_length").addClass("pass")}if(o[1].indexOf("NO_UPPERCASE_LETTERS")==-1&&o[1].indexOf("NO_LOWERCASE_LETTERS")==-1){i.find(".pw_check_uclc").addClass("pass")}if(o[1].indexOf("NO_NUMBERS")==-1){i.find(".pw_check_nums").addClass("pass")}if(o[1].indexOf("NO_SPECIAL_CHARACTERS")==-1){i.find(".pw_check_special").addClass("pass")}if(o[1].indexOf("CONTAINS_SPACE")==-1){i.find(".pw_check_spaces").addClass("pass")}if(o[1].indexOf("CONTAINS_PERSONAL_INFO")==-1){i.find(".pw_check_personal").addClass("pass")}if(o[1].indexOf("CONTAINS_COMMON_WORD")==-1){i.find(".pw_check_dictionary").addClass("pass")}if(t.val()==s.val()){i.find(".pw_check_match").addClass("pass")}}if(n.dictionary!=null){e.getJSON(n.dictionary,function(e){n.dictionaryWords=e})}t.keyup(function(){var o=e.fn.password("calculateScore",t,n);if(r!=null){r.find(".pass").removeClass("pass");if(o[2]){r.find(".weak").addClass("pass");if(o[0]>=50){r.find(".medium").addClass("pass")}if(o[0]>=80){r.find(".strong").addClass("pass")}}}if(i!=null){i.find(".pass").removeClass("pass");if(o[1].indexOf("TOO_SHORT")==-1){i.find(".pw_check_length").addClass("pass")}if(o[1].indexOf("NO_UPPERCASE_LETTERS")==-1&&o[1].indexOf("NO_LOWERCASE_LETTERS")==-1){i.find(".pw_check_uclc").addClass("pass")}if(o[1].indexOf("NO_NUMBERS")==-1){i.find(".pw_check_nums").addClass("pass")}if(o[1].indexOf("NO_SPECIAL_CHARACTERS")==-1){i.find(".pw_check_special").addClass("pass")}if(o[1].indexOf("CONTAINS_SPACE")==-1){i.find(".pw_check_spaces").addClass("pass")}if(o[1].indexOf("CONTAINS_PERSONAL_INFO")==-1){i.find(".pw_check_personal").addClass("pass")}if(o[1].indexOf("CONTAINS_COMMON_WORD")==-1){i.find(".pw_check_dictionary").addClass("pass")}if(t.val()==s.val()){i.find(".pw_check_match").addClass("pass")}}n.change.call(this,o[0],o[1],o[2])})})},calculateScore:function(t,n){var r=t.val();var i=0;var s=90;var o=true;var u=[];if(r.length>=n.minLength){i+=10}else{u.push("TOO_SHORT");o=false}if(r.match(/[A-Z]/g)!=null){i+=10}else{u.push("NO_UPPERCASE_LETTERS")}if(r.match(/[a-z]/g)!=null){i+=10}else{u.push("NO_LOWERCASE_LETTERS")}if(r.match(/[0-9]/g)!=null){i+=10}else{u.push("NO_NUMBERS")}if(!n.allowSpace&&r.match(/ /g)!=null){u.push("CONTAINS_SPACE");o=false}if(r.match(/(\W|_)/g)!=null){i+=10}else{u.push("NO_SPECIAL_CHARACTERS")}var a=[];e.each(n.personalInformation,function(t,n){if(typeof n!="string"){n=n.val()}if(n.length>0){var r=n.toLowerCase().split(" ");e.each(r,function(e,t){a.push(t);var n=t.match(/[1-2][0-9]{3}/g);if(n){a.push(n[0].substring(2,4))}})}});var f=r.toLowerCase();var l=false;e.each(a,function(e,t){var n=new RegExp(t,"g");if(f.match(n)!=null){l=true}});if(l){u.push("CONTAINS_PERSONAL_INFO")}else if(r.length>5){i+=20}var c=false;if(n.dictionaryWords!==undefined){e.each(n.dictionaryWords,function(e,t){var n=new RegExp(t,"g");if(f.match(n)!=null){c=true}})}if(c){u.push("CONTAINS_COMMON_WORD")}else if(r.length>5){i+=20}if(i/s<.3){o=false}if(r.length==0){o=false;u.push("EMPTY")}return[i/s*100,u,o]}};e.fn.password=function(n){if(t[n]){return t[n].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof n==="object"||!n){return t.init.apply(this,arguments)}else{e.error("Method "+n+" does not exist on jQuery.password")}}})(jQuery)