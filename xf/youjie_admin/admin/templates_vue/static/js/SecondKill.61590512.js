(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["SecondKill"],{"01fd":function(t,e,s){},"097d":function(t,e,s){"use strict";var a=s("5ca1"),i=s("8378"),o=s("7726"),r=s("ebd6"),l=s("bcaa");a(a.P+a.R,"Promise",{finally:function(t){var e=r(this,i.Promise||o.Promise),s="function"==typeof t;return this.then(s?function(s){return l(e,t()).then(function(){return s})}:t,s?function(s){return l(e,t()).then(function(){throw s})}:t)}})},1937:function(t,e,s){"use strict";var a=s("3b9c"),i=s.n(a);i.a},"1ea9":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"header"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",[t._v("有解商城管理中心")]),s("el-breadcrumb-item",[t._v("活动详情")])],1)],1),s("div",{staticClass:"activity-info-wrapper"},[s("p",[t._v("活动名称："+t._s(t.secbuy_info.secbuy_name))]),s("p",[t._v("活动时间："+t._s(t.fmtTime(t.secbuy_info.start_time)+" ~ "+t.fmtTime(t.secbuy_info.end_time)))])]),s("div",{staticClass:"goods-list-wrapper"},[s("p",[t._v("已绑定商品")]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.goods_info,stripe:"","header-cell-style":{background:"#eef1f6"}}},[s("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),s("el-table-column",{attrs:{label:"商品ID",prop:"goods_id"}}),s("el-table-column",{attrs:{label:"商品名称",prop:"goods_name","min-width":"300%","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{label:"所属商家",prop:"shop_name","min-width":"200%","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{label:"可售库存",prop:"goods_number"}}),s("el-table-column",{attrs:{label:"活动限购数量",prop:"secbuy_quantity","min-width":"120%"}}),s("el-table-column",{attrs:{label:"促销现金结算价",prop:"secbuy_close_price","min-width":"120%",formatter:t.fmtMoney}}),s("el-table-column",{attrs:{label:"促销积分结算价",prop:"ssettlement_surplus","min-width":"120%",formatter:t.fmtMoney}}),s("el-table-column",{attrs:{label:"原价","min-width":"200%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.goods_shop_price)))]),s("p",[t._v("\n            "+t._s("(现金:"+t.utils.formatMoney(e.row.goods_cash)+" + 积分:"+t.utils.formatMoney(e.row.goods_money_line)+")")+"\n          ")])]}}])}),s("el-table-column",{attrs:{label:"促销价","min-width":"200%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.shop_price)))]),s("p",[t._v("\n            "+t._s("(现金:"+t.utils.formatMoney(e.row.cash_price)+" + 积分:"+t.utils.formatMoney(e.row.huanbi_price)+")")+"\n          ")])]}}])})],1)],1),s("el-pagination",{attrs:{"hide-on-single-page":!0,"current-page":t.params.pageNumber,"page-size":t.params.pageSize,background:"",layout:"prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.params,"pageNumber",e)},"update:current-page":function(e){return t.$set(t.params,"pageNumber",e)}}}),s("div",{staticClass:"btn-wrapper"},[s("el-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1)],1)},i=[],o=s("3b8b"),r=(s("873b"),{name:"SecondKillDetail",data(){return{secbuy_info:[],goods_info:[],params:{secbuy_id:this.$route.params.id,pageNumber:1,pageSize:5},currentPage:1,total:0,loading:!1}},created(){this.getActivityDetail()},methods:{getActivityDetail(){this.loading=!0,Object(o["a"])(this.params).then(t=>{this.secbuy_info=t.secbuy_info,this.goods_info=t.list,this.total=t.total,this.loading=!1})},handleCurrentChange(){this.getActivityDetail()},fmtTime(t){return this.utils.formatDate("YYYY-MM-DD HH:mm:ss",this.utils.formatStamp(t,"1"))},fmtMoney(t,e){return this.utils.formatMoney(t[e.property])}}}),l=r,n=(s("8867"),s("2877")),c=Object(n["a"])(l,a,i,!1,null,"488f5142",null);e["default"]=c.exports},"217b":function(t,e,s){"use strict";var a=s("f644"),i=s.n(a);i.a},"21a6":function(t,e,s){(function(s){var a,i,o;(function(s,r){i=[],a=r,o="function"===typeof a?a.apply(e,i):a,void 0===o||(t.exports=o)})(0,function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function a(t,e,s){var a=new XMLHttpRequest;a.open("GET",t),a.responseType="blob",a.onload=function(){l(a.response,e,s)},a.onerror=function(){console.error("could not download file")},a.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function o(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(a){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof s&&s.global===s?s:void 0,l=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype?function(t,e,s){var l=r.URL||r.webkitURL,n=document.createElement("a");e=e||t.name||"download",n.download=e,n.rel="noopener","string"==typeof t?(n.href=t,n.origin===location.origin?o(n):i(n.href)?a(t,e,s):o(n,n.target="_blank")):(n.href=l.createObjectURL(t),setTimeout(function(){l.revokeObjectURL(n.href)},4e4),setTimeout(function(){o(n)},0))}:"msSaveOrOpenBlob"in navigator?function(t,s,r){if(s=s||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,r),s);else if(i(t))a(t,s,r);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout(function(){o(l)})}}:function(t,e,s,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return a(t,e,s);var o="application/octet-stream"===t.type,l=/constructor/i.test(r.HTMLElement)||r.safari,n=/CriOS\/[\d]+/.test(navigator.userAgent);if((n||o&&l)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=n?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},c.readAsDataURL(t)}else{var u=r.URL||r.webkitURL,d=u.createObjectURL(t);i?i.location=d:location.href=d,i=null,setTimeout(function(){u.revokeObjectURL(d)},4e4)}});r.saveAs=l.saveAs=l,t.exports=l})}).call(this,s("c8ba"))},"2f40":function(t,e,s){"use strict";var a=s("6e82"),i=s.n(a);i.a},"37ba":function(t,e,s){"use strict";var a=s("4739"),i=s.n(a);i.a},3837:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"container"},[s("page-title",{attrs:{"first-title":"编辑商品"}}),s("div",{staticClass:"good-info-wrapper"},[s("el-form",{ref:"goodForm",attrs:{"label-width":"120px",rules:t.goodRules,model:t.good_infos}},[s("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_name,callback:function(e){t.$set(t.good_infos,"goods_name",e)},expression:"good_infos.goods_name"}})],1),s("el-form-item",{attrs:{label:"商品编号",prop:"goods_id"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_id,callback:function(e){t.$set(t.good_infos,"goods_id",e)},expression:"good_infos.goods_id"}})],1),s("el-form-item",{attrs:{label:"所属店铺",prop:"shop_name"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.shop_name,callback:function(e){t.$set(t.good_infos,"shop_name",e)},expression:"good_infos.shop_name"}})],1),s("el-form-item",{attrs:{label:"秒杀结算价",prop:"secbuy_close_price"}},[s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.secbuy_close_price,callback:function(e){t.$set(t.good_infos,"secbuy_close_price",e)},expression:"good_infos.secbuy_close_price"}}),s("span",[t._v("注：请输入数字(下同)")])],1),s("el-form-item",{attrs:{label:"秒杀价",prop:"shop_price"}},[s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.shop_price,callback:function(e){t.$set(t.good_infos,"shop_price",e)},expression:"good_infos.shop_price"}}),s("div",{staticClass:"price-wrapper"},[s("p",[s("label",[t._v("现金价")]),s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.cash_price,callback:function(e){t.$set(t.good_infos,"cash_price",e)},expression:"good_infos.cash_price"}})],1),s("p",[s("label",[t._v("积分支付上限")]),s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.huanbi_price,callback:function(e){t.$set(t.good_infos,"huanbi_price",e)},expression:"good_infos.huanbi_price"}})],1)])],1),s("el-form-item",{attrs:{label:"原价",prop:"goods_shop_price"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_shop_price,callback:function(e){t.$set(t.good_infos,"goods_shop_price",e)},expression:"good_infos.goods_shop_price"}}),s("div",{staticClass:"price-wrapper"},[s("p",[s("label",[t._v("现金价")]),s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_cash,callback:function(e){t.$set(t.good_infos,"goods_cash",e)},expression:"good_infos.goods_cash"}})],1),s("p",[s("label",[t._v("积分支付上限")]),s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_money_line,callback:function(e){t.$set(t.good_infos,"goods_money_line",e)},expression:"good_infos.goods_money_line"}})],1)])],1),s("el-form-item",{attrs:{label:"可售库存",prop:"goods_number"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_number,callback:function(e){t.$set(t.good_infos,"goods_number",e)},expression:"good_infos.goods_number"}})],1),s("el-form-item",{attrs:{label:"秒杀库存",prop:"secbuy_quantity"}},[s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.secbuy_quantity,callback:function(e){t.$set(t.good_infos,"secbuy_quantity",e)},expression:"good_infos.secbuy_quantity"}})],1),s("el-form-item",{attrs:{label:"每人限购",prop:"max_quantity"}},[s("el-input",{model:{value:t.good_infos.max_quantity,callback:function(e){t.$set(t.good_infos,"max_quantity",e)},expression:"good_infos.max_quantity"}})],1),s("el-form-item",{attrs:{label:"排序值",prop:"goods_order"}},[s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.goods_order,callback:function(e){t.$set(t.good_infos,"goods_order",e)},expression:"good_infos.goods_order"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.saveGood}},[t._v("确定")]),s("el-button",{on:{click:t.goBack}},[t._v("返回")])],1)],1)],1)],1)},i=[],o=(s("a481"),s("3b8b")),r={name:"KillGoodEdit",data(){let t=(t,e,s)=>{e&&(Number(e)>Number(this.good_infos.goods_number)?s(new Error("活动限购数量不得大于库存")):s())},e=(t,e,s)=>{this.good_infos.secbuy_quantity&&Number(e)>Number(this.good_infos.secbuy_quantity)?s(new Error("每人限购不得大于活动限购数量")):s()},s=(t,e,s)=>{""!=e&&""!=this.good_infos.cash_price&&Number(e)<Number(this.good_infos.cash_price)?(s(new Error("秒杀价需大于等于现金价")),this.good_infos.shop_price="",this.good_infos.cash_price=""):s()},a=(t,e,s)=>{e&&(isNaN(e)?s(new Error("请输入数字")):s())};return{notEdit:!0,good_infos:{},goodRules:{secbuy_close_price:[{required:!0,message:"秒杀结算价必填",trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}],shop_price:[{required:!0,message:"秒杀价必填",trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"},{validator:s,trigger:"blur"}],secbuy_quantity:[{required:!0,message:"活动限购数量必填",trigger:"blur"},{validator:t,trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}],max_quantity:[{required:!0,message:"每人限购数量必填",trigger:"blur"},{validator:e,trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}],goods_order:[{required:!0,message:"排序值必填",trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}]},current_token_type:"",loading:!0,javaData:{ori_secbuy_quantity:"",secbuy_goods_id:this.$route.params.goodID?this.$route.params.goodID:""}}},created(){Object(o["f"])(this.$route.params.goodID).then(t=>{this.good_infos=t[0],this.current_token_type=t[0].token_type,this.loading=!1,this.javaData.ori_secbuy_quantity=t[0].secbuy_quantity})},watch:{shop_cash_price(t){this.good_infos.huanbi_price=Number(t.shop_price)-Number(t.cash_price)}},computed:{shop_cash_price(){let t={shop_price:this.good_infos.shop_price,cash_price:this.good_infos.cash_price};return t}},methods:{saveGood(){this.$refs["goodForm"].validate(t=>{if(t){if(Number(this.good_infos.shop_price)!==Number(this.good_infos.cash_price)+Number(this.good_infos.huanbi_price))return void this.$message.error("秒杀价为现金价与积分支付上限的和");console.log(this.javaData.ori_secbuy_quantity),console.log(this.good_infos.secbuy_quantity),this.javaData.ori_secbuy_quantity!=Number(this.good_infos.secbuy_quantity)?(console.log(this.javaData),console.log(this.javaData.secbuy_goods_id),this.$api.put("hd/itzSecbuyGoods/secbuy/goods?secbuy_goods_id=".concat(this.javaData.secbuy_goods_id,"&ori_secbuy_quantity=").concat(this.javaData.ori_secbuy_quantity,"&secbuy_quantity=").concat(this.good_infos.secbuy_quantity),null,t=>{200==t.status&&Object(o["i"])(this.good_infos).then(t=>{t&&(this.$message.success("保存成功"),this.goBack())},t=>{this.$message({message:t.errorMsg,type:"error"}),"1001"==t.errorCode?this.good_infos.shop_price="":"1002"==t.errorCode?this.good_infos.cash_price="":"1003"==t.errorCode?this.good_infos.shop_price="":"1004"==t.errorCode&&(this.good_infos.cash_price="")})})):Object(o["i"])(this.good_infos).then(t=>{t&&(this.$message.success("保存成功"),this.goBack())},t=>{this.$message({message:t.errorMsg,type:"error"}),"1001"==t.errorCode?this.good_infos.shop_price="":"1002"==t.errorCode?this.good_infos.cash_price="":"1003"==t.errorCode?this.good_infos.shop_price="":"1004"==t.errorCode&&(this.good_infos.cash_price="")})}})},goBack(){this.$router.replace({name:"SecondKillAdd",query:{id:this.$route.params.actID}})}}},l=r,n=(s("8220"),s("2877")),c=Object(n["a"])(l,a,i,!1,null,"ed7e764c",null);e["default"]=c.exports},"3b8b":function(t,e,s){"use strict";s.d(e,"c",function(){return i}),s.d(e,"a",function(){return o}),s.d(e,"e",function(){return r}),s.d(e,"g",function(){return l}),s.d(e,"d",function(){return n}),s.d(e,"b",function(){return c}),s.d(e,"i",function(){return u}),s.d(e,"h",function(){return d}),s.d(e,"f",function(){return _}),s.d(e,"k",function(){return p}),s.d(e,"j",function(){return m}),s.d(e,"l",function(){return g});var a=s("65c6");const i=t=>Object(a["a"])("/admin/api.seckill.activity.add","POST",{secbuy_id:t.secbuy_id,secbuy_name:t.secbuy_name,start_time:t.start_time,end_time:t.end_time,pageNumber:t.pageNumber,pageSize:t.pageSize,is_select:t.is_select,secbuy_status:t.secbuy_status,data:t.productlist}),o=t=>Object(a["a"])("/admin/api.seckill.activity.look","POST",{secbuy_id:t.secbuy_id,pageNumber:t.pageNumber,pageSize:t.pageSize}),r=t=>Object(a["a"])("/admin/api.seckill.activity.disable","POST",{secbuy_id:t}),l=t=>Object(a["a"])("/admin/api.seckill.activity.open","POST",{secbuy_id:t}),n=t=>Object(a["a"])("/admin/api.seckill.activity.del","POST",{secbuy_id:t}),c=t=>Object(a["a"])("/admin/api.seckill.activity.find","POST",t),u=t=>Object(a["a"])("/admin/api.seckill.goods.edit","POST",t),d=t=>Object(a["a"])("/admin/api.seckill.goods.del","POST",{id:t}),_=t=>Object(a["a"])("/admin/api.seckill.goods.single","POST",{id:t}),p=t=>Object(a["a"])("/admin/api.seckill.goods.sale","POST",{id:t}),m=t=>Object(a["a"])("/admin/api.seckill.activity.add","POST",t),g=t=>Object(a["b"])("/admin/api.seckill.goods.template","POST")},"3b9c":function(t,e,s){},4739:function(t,e,s){},5416:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.loading,expression:"loading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"container"},[s("div",{staticClass:"header"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",[t._v("有解商城管理中心")]),s("el-breadcrumb-item",[t._v("运营活动管理")]),s("el-breadcrumb-item",[t._v("编辑商品")])],1)],1),s("div",{staticClass:"good-info-wrapper"},[s("el-form",{ref:"goodForm",attrs:{"label-width":"150px",rules:t.goodRules,model:t.good_infos}},[s("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_name,callback:function(e){t.$set(t.good_infos,"goods_name",e)},expression:"good_infos.goods_name"}})],1),s("el-form-item",{attrs:{label:"可售库存",prop:"goods_number"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.remain_goods_number,callback:function(e){t.remain_goods_number=e},expression:"remain_goods_number"}})],1),s("el-form-item",{attrs:{label:"活动限购数量",prop:"secbuy_quantity"}},[s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.secbuy_quantity,callback:function(e){t.$set(t.good_infos,"secbuy_quantity",e)},expression:"good_infos.secbuy_quantity"}}),s("span",[t._v("注：请输入数字(下同)")])],1),s("el-form-item",{attrs:{label:"促销现金结算价",prop:"secbuy_close_price"}},[s("el-input",{model:{value:t.good_infos.secbuy_close_price,callback:function(e){t.$set(t.good_infos,"secbuy_close_price",e)},expression:"good_infos.secbuy_close_price"}})],1),s("el-form-item",{attrs:{label:"促销积分结算价",prop:"settlement_surplus"}},[s("el-input",{model:{value:t.good_infos.settlement_surplus,callback:function(e){t.$set(t.good_infos,"settlement_surplus",e)},expression:"good_infos.settlement_surplus"}})],1),s("el-form-item",{attrs:{label:"原价",prop:"goods_shop_price"}},[s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_shop_price,callback:function(e){t.$set(t.good_infos,"goods_shop_price",e)},expression:"good_infos.goods_shop_price"}}),s("div",{staticClass:"price-wrapper"},[s("p",[s("label",[t._v("现金")]),s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_cash,callback:function(e){t.$set(t.good_infos,"goods_cash",e)},expression:"good_infos.goods_cash"}})],1),s("p",[s("label",[t._v("积分")]),s("el-input",{attrs:{disabled:t.notEdit},model:{value:t.good_infos.goods_money_line,callback:function(e){t.$set(t.good_infos,"goods_money_line",e)},expression:"good_infos.goods_money_line"}})],1)])],1),s("el-form-item",{attrs:{label:"促销价",prop:"shop_price"}},[2==t.good_infos.secbuy_type?[s("el-input",{attrs:{disabled:t.notEdit,clearable:""},model:{value:t.total_cash_price,callback:function(e){t.total_cash_price=e},expression:"total_cash_price"}}),s("span",[t._v("折扣: "+t._s(t.currentDiscount))]),s("div",{staticClass:"price-wrapper"},[s("p",[s("label",[t._v("现金")]),s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.cash_price,callback:function(e){t.$set(t.good_infos,"cash_price",e)},expression:"good_infos.cash_price"}})],1),s("p",[s("label",[t._v("积分")]),s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.huanbi_price,callback:function(e){t.$set(t.good_infos,"huanbi_price",e)},expression:"good_infos.huanbi_price"}})],1)])]:[s("el-input",{attrs:{disabled:t.notEdit,clearable:""},model:{value:t.good_infos.shop_price,callback:function(e){t.$set(t.good_infos,"shop_price",e)},expression:"good_infos.shop_price"}}),s("div",{staticClass:"price-wrapper"},[s("p",[s("label",[t._v("现金")]),s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.cash_price,callback:function(e){t.$set(t.good_infos,"cash_price",e)},expression:"good_infos.cash_price"}})],1),s("p",[s("label",[t._v("积分")]),s("el-input",{attrs:{clearable:""},model:{value:t.good_infos.huanbi_price,callback:function(e){t.$set(t.good_infos,"huanbi_price",e)},expression:"good_infos.huanbi_price"}})],1)])]],2),s("el-form-item",{attrs:{label:"每人限购",prop:"max_quantity"}},[s("p",{staticClass:"radio-wrapper-p"},[s("el-radio",{attrs:{label:"1"},model:{value:t.limit_buy,callback:function(e){t.limit_buy=e},expression:"limit_buy"}},[t._v("不限")])],1),s("p",{staticClass:"radio-wrapper-p"},[s("el-radio",{attrs:{label:"2"},model:{value:t.limit_buy,callback:function(e){t.limit_buy=e},expression:"limit_buy"}},[t._v("数量")]),s("el-input",{attrs:{disabled:"2"!=t.limit_buy},model:{value:t.good_infos.max_quantity,callback:function(e){t.$set(t.good_infos,"max_quantity",e)},expression:"good_infos.max_quantity"}})],1)]),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:t.saveGood}},[t._v("确定")]),s("el-button",{on:{click:t.goBack}},[t._v("返回")])],1)],1)],1)])},i=[],o=(s("a481"),s("3b8b")),r={name:"KillGoodEdit",data(){let t=(t,e,s)=>{e&&(Number(e)>this.total_goods_number?s(new Error("活动限购数量不得大于库存")):s())},e=(t,e,s)=>{this.good_infos.secbuy_quantity&&Number(e)>Number(this.good_infos.secbuy_quantity)?s(new Error("每人限购不得大于活动限购数量")):s()},s=(t,e,s)=>{2==this.good_infos.secbuy_type&&Number(e)>=Number(this.good_infos.goods_shop_price)?s(new Error("促销价需小于原价")):s()},a=(t,e,s)=>{e&&(isNaN(e)?s(new Error("请输入数字")):s())};return{notEdit:!0,good_infos:{},goodRules:{secbuy_close_price:[{required:!0,message:"促销现金结算价必填",trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}],shop_price:[{required:!0,message:"促销价必填",trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"},{validator:s,trigger:"blur"}],secbuy_quantity:[{required:!0,message:"活动限购数量必填",trigger:"blur"},{validator:t,trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}],max_quantity:[{required:!0,message:"每人限购数量必填",trigger:"blur"},{validator:e,trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}],goods_order:[{required:!0,message:"排序值必填",trigger:"blur"},{validator:a,message:"请输入数字",trigger:"blur"}]},loading:!1,limit_buy:"1",total_goods_number:void 0}},computed:{total_cash_price(){return this.good_infos.shop_price=Number(this.good_infos.huanbi_price)+Number(this.good_infos.cash_price),this.good_infos.shop_price},current_cash_price(){return this.good_infos.cash_price},current_huanbi_price(){return this.good_infos.huanbi_price},remain_goods_number(){return this.total_goods_number-Number(this.good_infos.secbuy_quantity)},currentDiscount(){return(10*Number(this.good_infos.shop_price)/Number(this.good_infos.goods_shop_price)).toFixed(1)}},watch:{current_cash_price(){1==this.good_infos.secbuy_type&&(this.good_infos.huanbi_price=Number(this.good_infos.shop_price)-Number(this.good_infos.cash_price))},current_huanbi_price(){1==this.good_infos.secbuy_type&&(this.good_infos.cash_price=Number(this.good_infos.shop_price)-Number(this.good_infos.huanbi_price))}},created(){this.loading=!0,Object(o["f"])(this.$route.params.goodID).then(t=>{this.good_infos=t[0],this.total_goods_number=Number(this.good_infos.goods_number)+Number(this.good_infos.secbuy_quantity),this.limit_buy=this.good_infos.max_quantity>0?"2":"1",this.loading=!1})},methods:{saveGood(){this.$refs["goodForm"].validate(t=>{if(t){if(1==this.good_infos.secbuy_type&&this.good_infos.huanbi_price<=this.good_infos.goods_money_line)return void this.$message.error("积分尊享活动的积分价必须大于原价的积分价");"1"==this.limit_buy&&(this.good_infos.max_quantity=0),Object(o["i"])(this.good_infos).then(t=>{t&&(this.$message.success("保存成功"),this.goBack())})}})},goBack(){this.$router.replace({name:"PromoteSaleAdd",query:{id:this.$route.params.actID}})}}},l=r,n=(s("37ba"),s("2877")),c=Object(n["a"])(l,a,i,!1,null,"68ddeae0",null);e["default"]=c.exports},"5e1b":function(t,e,s){},6045:function(t,e,s){"use strict";s.d(e,"b",function(){return a}),s.d(e,"a",function(){return i});const a=[{status_id:0,status_name:"未开始"},{status_id:1,status_name:"进行中"},{status_id:2,status_name:"已结束"},{status_id:3,status_name:"已禁用"}],i=[{type_id:0,type_name:"不限"},{type_id:1,type_name:"仅积分"},{type_id:2,type_name:"仅浣豆"}]},"6e82":function(t,e,s){},"814c":function(t,e,s){"use strict";var a=s("8d01"),i=s.n(a);i.a},8220:function(t,e,s){"use strict";var a=s("b58d"),i=s.n(a);i.a},"873b":function(t,e,s){"use strict";s.d(e,"c",function(){return a}),s.d(e,"b",function(){return i}),s.d(e,"a",function(){return o});const a=[{status_id:0,status_name:"未开始"},{status_id:1,status_name:"进行中"},{status_id:2,status_name:"已结束"}],i=[{type_id:0,type_name:"不限"},{type_id:1,type_name:"仅积分"},{type_id:2,type_name:"仅浣豆"}],o=[{id:1,name:"积分专享"},{id:2,name:"限时折扣"}]},8867:function(t,e,s){"use strict";var a=s("bb74"),i=s.n(a);i.a},"8d01":function(t,e,s){},"8f78":function(t,e,s){"use strict";var a=s("b21a"),i=s.n(a);i.a},a5b8:function(t,e,s){"use strict";var a=s("d8e8");function i(t){var e,s;this.promise=new t(function(t,a){if(void 0!==e||void 0!==s)throw TypeError("Bad Promise constructor");e=t,s=a}),this.resolve=a(e),this.reject=a(s)}t.exports.f=function(t){return new i(t)}},b21a:function(t,e,s){},b58d:function(t,e,s){},b5dc:function(t,e,s){"use strict";var a=s("01fd"),i=s.n(a);i.a},bb68:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("page-title",{attrs:{"first-title":"限时抢购"}}),s("div",{staticClass:"search-wrapper"},[s("el-form",{attrs:{inline:!0}},[s("el-row",{staticStyle:{"margin-right":"0"},attrs:{gutter:20}},[s("el-form-item",{attrs:{label:"活动名称"}},[s("el-input",{attrs:{placeholder:"活动名称",clearable:""},model:{value:t.params.secbuy_name,callback:function(e){t.$set(t.params,"secbuy_name",e)},expression:"params.secbuy_name"}})],1),s("el-form-item",{attrs:{label:"创建时间"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间","value-format":"timestamp"},model:{value:t.params.create_start_time,callback:function(e){t.$set(t.params,"create_start_time",e)},expression:"params.create_start_time"}}),s("span",[t._v("  ~  ")]),s("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间","value-format":"timestamp"},model:{value:t.params.create_end_time,callback:function(e){t.$set(t.params,"create_end_time",e)},expression:"params.create_end_time"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addNewActivity}},[t._v("\n              新增\n            ")])],1)],1),s("el-row",{staticStyle:{"margin-right":"0"},attrs:{gutter:20}},[s("el-form-item",{attrs:{label:"活动状态"}},[s("el-select",{attrs:{clearable:"",placeholder:"活动状态"},model:{value:t.params.secbuy_status,callback:function(e){t.$set(t.params,"secbuy_status",e)},expression:"params.secbuy_status"}},t._l(t.statusList,function(t){return s("el-option",{key:t.status_id,attrs:{label:t.status_name,value:t.status_id}})}),1)],1),s("el-form-item",{attrs:{label:"活动时间"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间","value-format":"timestamp"},model:{value:t.params.start_time,callback:function(e){t.$set(t.params,"start_time",e)},expression:"params.start_time"}}),s("span",[t._v("  ~  ")]),s("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间","value-format":"timestamp"},model:{value:t.params.end_time,callback:function(e){t.$set(t.params,"end_time",e)},expression:"params.end_time"}})],1),s("el-form-item",[s("el-button",{attrs:{icon:"el-icon-search"},on:{click:t.getActivityList}},[t._v("\n              搜索\n            ")])],1)],1)],1)],1),s("div",{staticClass:"list-wrapper"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.activityList,stripe:"","header-cell-style":{background:"#eef1f6"}}},[s("el-table-column",{attrs:{prop:"secbuy_id",label:"序号"}}),s("el-table-column",{attrs:{prop:"secbuy_name",label:"活动名称","min-width":"450px"}}),s("el-table-column",{attrs:{label:"活动时间","min-width":"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t.timeStampFmt(e.row,"start_time")))]),t._v("\n              至  \n            "),s("span",[t._v(t._s(t.timeStampFmt(e.row,"end_time")))])]}}])}),s("el-table-column",{attrs:{prop:"secbuy_status",label:"活动状态",formatter:t.statusFmt}}),s("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"180px",formatter:t.timeStampFmt}}),s("el-table-column",{attrs:{label:"操作","min-width":"200px"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goDetail(e.row.secbuy_id)}}},[t._v("\n              查看\n            ")]),0===e.row.secbuy_status||1===e.row.secbuy_status||3===e.row.secbuy_status?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goEdit(e.row)}}},[t._v("\n              编辑\n            ")]):t._e(),0===e.row.secbuy_status?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goForbid(e.row)}}},[t._v("\n              禁用\n            ")]):t._e(),0===e.row.secbuy_status||3===e.row.secbuy_status?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goRemove(e.row.secbuy_id)}}},[t._v("\n              移除\n            ")]):t._e()]}}])})],1)],1),s("el-pagination",{attrs:{"current-page":t.currentPage,background:"",layout:"prev, pager, next, jumper",total:t.total,"hide-on-single-page":!0},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)},i=[],o=s("6045"),r=s("3b8b"),l={name:"SecondKill",data(){return{params:{pageNumber:1,pageSize:10,secbuy_name:"",start_time:"",end_time:"",create_start_time:"",create_end_time:"",secbuy_status:""},currentPage:1,total:0,activityList:[],statusList:o["b"],loading:null,isStart:!1}},created(){this.getActivityList()},computed:{canEdit(){}},methods:{getActivityList(){this.loading=!0;let t=JSON.parse(JSON.stringify(this.params));for(let e in t)e.endsWith("_time")&&t[e]&&(t[e]=this.utils.formatStamp(t[e]));Object(r["b"])(t).then(t=>{this.activityList=t.data,this.total=t.total,this.loading=!1})},addNewActivity(){this.$router.push({name:"SecondKillAdd",query:{operate:"add"}})},goDetail(t){this.$router.push({name:"SecondKillDetail",params:{id:t}})},goEdit(t){this.$router.push({name:"SecondKillAdd",query:{id:t.secbuy_id,status:t.secbuy_status}})},goForbid(t){this.$confirm("确定禁用本场活动吗","提示").then(()=>{Object(r["e"])(t.secbuy_id).then(e=>{e&&(t.secbuy_status=3,this.$message.success("禁用成功"))})})},goRemove(t){this.$confirm("确定移除该活动吗？","提示").then(()=>{this.loading=!0,this.$api.delete("hd/itzSecbuyGoods/batch?secbuy_id=".concat(t),null,e=>{200==e.status&&Object(r["d"])(t).then(t=>{t&&this.getActivityList()})})})},goStart(t){this.$confirm("确定开启本场活动吗？","提示").then(()=>{let e=parseInt(this.utils.formatStamp((new Date).getTime()));t.start_time<=e?this.$confirm("活动开始时间需大于当前时间，请修改活动时间","提示").then(()=>{this.isStart=!0,this.goEdit(t)}):Object(r["g"])(t.secbuy_id).then(e=>{t.secbuy_status=0})})},timeStampFmt(t,e){let s="string"===typeof e?e:e.property,a=t[s];return a?this.utils.formatDate("YYYY-MM-DD HH:mm:ss",this.utils.formatStamp(a,1)):a},statusFmt(t,e){let s=t[e.property];return o["b"].map(function(t){return t.status_id===s?t.status_name:void 0})},handleCurrentChange(){this.params.pageNumber=this.currentPage,this.getActivityList()},addNewEnroll(){this.$router.push({name:"addNewEnroll"})}}},n=l,c=(s("b5dc"),s("2877")),u=Object(c["a"])(n,a,i,!1,null,"2fa82400",null);e["default"]=u.exports},bb74:function(t,e,s){},bcaa:function(t,e,s){var a=s("cb7c"),i=s("d3f4"),o=s("a5b8");t.exports=function(t,e){if(a(t),i(e)&&e.constructor===t)return e;var s=o.f(t),r=s.resolve;return r(e),s.promise}},c612:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("page-title",{attrs:{"first-title":"活动详情"}}),s("div",{staticClass:"activity-info-wrapper"},[s("p",[t._v("活动名称："+t._s(t.secbuy_info.secbuy_name))]),s("p",[t._v("活动时间："+t._s(t.fmtTime(t.secbuy_info.start_time)+" ~ "+t.fmtTime(t.secbuy_info.end_time)))])]),s("div",{staticClass:"goods-list-wrapper"},[s("p",[t._v("已绑定商品")]),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.goods_info,stripe:"","header-cell-style":{background:"#eef1f6"}}},[s("el-table-column",{attrs:{label:"序号",prop:"id"}}),s("el-table-column",{attrs:{label:"商品编号",prop:"goods_id"}}),s("el-table-column",{attrs:{label:"商品名称",prop:"goods_name"}}),s("el-table-column",{attrs:{label:"排序值",prop:"goods_order"}}),s("el-table-column",{attrs:{label:"可售库存",prop:"goods_number"}}),s("el-table-column",{attrs:{label:"活动限购数量",prop:"secbuy_quantity"}}),s("el-table-column",{attrs:{label:"每人限购",prop:"max_quantity"}}),s("el-table-column",{attrs:{label:"秒杀结算价",prop:"secbuy_close_price",formatter:t.fmtMoney}}),s("el-table-column",{attrs:{label:"原价"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.goods_shop_price)))]),s("p",[t._v("\n              "+t._s("(现金价:"+t.utils.formatMoney(e.row.goods_cash)+" + 积分支付上限:"+t.utils.formatMoney(e.row.goods_money_line)+")")+"\n            ")])]}}])}),s("el-table-column",{attrs:{label:"秒杀总价"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.shop_price)))]),s("p",[t._v("\n              "+t._s("(现金价:"+t.utils.formatMoney(e.row.cash_price)+" + 积分支付上限:"+t.utils.formatMoney(e.row.huanbi_price)+")")+"\n            ")])]}}])}),s("el-table-column",{attrs:{label:"秒杀支付类型",prop:"token_type",formatter:t.fmtPayType}}),s("el-table-column",{attrs:{label:"所属店铺",prop:"shop_name"}})],1)],1),s("el-pagination",{attrs:{"hide-on-single-page":!0,"current-page":t.currentPage,"page-size":t.params.pageSize,background:"",layout:"prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}}),s("div",{staticClass:"btn-wrapper"},[s("el-button",{on:{click:function(e){return t.$router.go(-1)}}},[t._v("返回")])],1)],1)},i=[],o=s("3b8b"),r=s("6045"),l={name:"SecondKillDetail",data(){return{secbuy_info:[],goods_info:[],params:{secbuy_id:this.$route.params.id,pageNumber:1,pageSize:5},currentPage:1,total:0,loading:null}},created(){this.getActivityDetail()},methods:{getActivityDetail(){this.loading=!0,Object(o["a"])(this.params).then(t=>{this.secbuy_info=t.secbuy_info,this.goods_info=t.list,this.total=t.total,this.loading=!1})},handleCurrentChange(){console.log("current page is ",this.currentPage),this.params.pageNumber=this.currentPage,this.getActivityDetail()},fmtTime(t){return this.utils.formatDate("YYYY-MM-DD HH:mm:ss",this.utils.formatStamp(t,"1"))},fmtMoney(t,e){return this.utils.formatMoney(t[e.property])},fmtPayType(t,e){let s=t[e.property];return r["a"].map(function(t){return t.type_id===s?t.type_name:void 0})}}},n=l,c=(s("814c"),s("2877")),u=Object(c["a"])(n,a,i,!1,null,"24a7a60a",null);e["default"]=u.exports},c727:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"container"},[s("page-title",{attrs:{"first-title":t.isAdd?"新增活动":"编辑活动"}}),s("div",{staticClass:"activity-info-wrapper"},[s("el-form",{ref:"activityForm",attrs:{"label-width":"120px",rules:t.addRules,model:t.activity_infos}},[s("el-form-item",{attrs:{label:"活动名称",prop:"secbuy_name"}},[s("el-input",{attrs:{placeholder:"请输入活动名称",clearable:"",disabled:t.isDisable},model:{value:t.activity_infos.secbuy_name,callback:function(e){t.$set(t.activity_infos,"secbuy_name",e)},expression:"activity_infos.secbuy_name"}})],1),s("el-form-item",{attrs:{label:"活动开始时间",prop:"start_time"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择活动开始时间","value-format":"timestamp","default-time":"00:00:00",disabled:t.isDisable},model:{value:t.activity_infos.start_time,callback:function(e){t.$set(t.activity_infos,"start_time",e)},expression:"activity_infos.start_time"}})],1),s("el-form-item",{attrs:{label:"活动结束时间",prop:"end_time"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择活动结束时间","value-format":"timestamp","default-time":"23:59:59",disabled:t.isDisable},model:{value:t.activity_infos.end_time,callback:function(e){t.$set(t.activity_infos,"end_time",e)},expression:"activity_infos.end_time"}})],1)],1)],1),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.submitLoading,expression:"submitLoading"}],staticClass:"goods-list-wrapper"},[s("div",{staticClass:"import-good-wrapper"},[s("span",[t._v("*")]),s("label",[t._v("关联商品")]),s("el-upload",{ref:"uploadFile",attrs:{headers:t.importHeaders,action:t.action,data:t.postParams,name:"myfile","auto-upload":!1,"on-success":t.uploadSuccess,"on-change":t.addFile,"before-remove":t.removeFile,limit:1,"on-exceed":t.overFile}},[s("el-button",{attrs:{type:"primary",disabled:t.isDisable||t.mutex0}},[t._v("导入商品")])],1),s("el-button",{staticClass:"tpl-download",attrs:{type:"text",disabled:t.isDisable},on:{click:t.downloadTpl}},[t._v("模板下载")])],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticStyle:{width:"100%"},attrs:{data:t.goods_info,stripe:"",border:"","header-cell-style":{background:"#eef1f6"}}},[[t.isProduct?s("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}):s("el-table-column",{attrs:{label:"序号",prop:"id",width:"50"}})],s("el-table-column",{attrs:{label:"商品编号:",prop:"goods_id"}}),s("el-table-column",{attrs:{label:"商品名称",prop:"goods_name"}}),s("el-table-column",{attrs:{label:"排序值",prop:"goods_order"}}),s("el-table-column",{attrs:{label:"可售库存",prop:"goods_number"}}),s("el-table-column",{attrs:{label:"秒杀库存",prop:"secbuy_quantity"}}),s("el-table-column",{attrs:{label:"每人限购",prop:"max_quantity"}}),s("el-table-column",{attrs:{label:"秒杀结算价",prop:"secbuy_close_price",formatter:t.fmtMoney}}),s("el-table-column",{attrs:{label:"原价",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.goods_shop_price)))]),s("p",[t._v("\n            "+t._s("(现金价:"+t.utils.formatMoney(e.row.goods_cash)+" + 积分支付上限:"+t.utils.formatMoney(e.row.goods_money_line)+")")+"\n          ")])]}}])}),s("el-table-column",{attrs:{label:"秒杀总价",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.shop_price)))]),s("p",[t._v("\n            "+t._s("(现金价:"+t.utils.formatMoney(e.row.cash_price)+" + 积分支付上限:"+t.utils.formatMoney(e.row.huanbi_price)+")")+"\n          ")])]}}])}),s("el-table-column",{attrs:{label:"所属店铺",prop:"shop_name"}}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.curStatus?s("div",[s("el-button",{attrs:{type:"text",size:"small",disabled:!e.row.is_on_sale},on:{click:function(s){return t.sellNone(e.row)}}},[t._v("售罄")])],1):s("div",[!t.isProduct||t.isProduct&t.activity_infos.secbuy_id?[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goEdit(e.row.id)}}},[t._v("\n                编辑\n              ")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goRemove(e.row.id)}}},[t._v("\n                移除\n              ")])]:[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.Removepro(e.row.goods_id)}}},[t._v("\n                移除\n              ")])]],2)]}}])})],2)],1),s("el-pagination",{attrs:{"current-page":t.currentPage,background:"",layout:"prev, pager, next, jumper","page-size":t.pageSize,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}}),s("div",{staticClass:"btn-groups-wrapper"},[s("el-button",{attrs:{type:"primary",disabled:t.notSave},on:{click:t.saveNewActivity}},[t._v("确定")]),s("el-button",{attrs:{type:""},on:{click:t.goback}},[t._v("返回")])],1),s("div",{staticClass:"error-good-info-wrapper"},[s("el-dialog",{attrs:{visible:t.centerDialogVisible,width:"50%","show-close":!1},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("导入商品提示")]),s("div",[s("div",[t.data_type.sale?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("已下架")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.sale))])],1):t._e(),t.data_type.goods_number?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("已售罄")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.goods_number))])],1):t._e(),t.data_type.sale_goods_number?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("售罄并下架")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.sale_goods_number))])],1):t._e(),t.data_type.check_zero?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("未审核")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.check_zero))])],1):t._e(),t.data_type.export_fail?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("导入失败")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.export_fail))])],1):t._e(),t.data_type.param_error?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("数据错误")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.param_error))])],1):t._e(),t.data_type.money_error?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("金额错误")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.money_error))])],1):t._e(),t.data_type.sku_goods?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("多规格SKU")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.sku_goods))])],1):t._e(),t.data_type.seckill_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("设置的秒杀价不能高于本店售价")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.seckill_price))])],1):t._e(),t.data_type.seckill_casg?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("设置的秒杀现金价不能高于本店售价中的现金价")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.seckill_casg))])],1):t._e(),t.data_type.shop_seckill_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("售价 - 秒杀价需大于等于 1")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.shop_seckill_price))])],1):t._e(),t.data_type.shop_seckill_cash?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("售价现金价 - 秒杀现金价需大于等于 1")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.shop_seckill_cash))])],1):t._e(),t.data_type.goods_name?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("商品编号与商品名称不一致，请修改后重新提交。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.goods_name))])],1):t._e(),t.data_type.discount_activity_shop_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("限时折扣活动价要低于本店售价。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.discount_activity_shop_price))])],1):t._e(),t.data_type.special_activity_shop_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("积分专享活动价不等于本店售价。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.special_activity_shop_price))])],1):t._e(),t.data_type.special_activity_money_line?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("积分专享抵扣上限小于默认权限抵扣上限。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.special_activity_money_line))])],1):t._e(),t.data_type.other_activity_running?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("已参与其他活动")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.other_activity_running))])],1):t._e(),s("p",[t._v("请仔细核对商品信息后重新上传失败数据")])],1)]),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("确 定")])],1)])],1)],1)},i=[],o=(s("a481"),s("be94")),r=s("3b8b"),l=s("21a6"),n=s("6045"),c=(s("2f62"),{name:"SecondKillAdd",data(){let t=(t,e,s)=>{""!==e&&(""!==this.activity_infos.start_time&&e<=this.activity_infos.start_time?(s(new Error("结束时间不能小于开始时间")),this.activity_infos.end_time=""):s())},e=(t,e,s)=>{""!==e&&(""!==this.activity_infos.end_time&&e>=this.activity_infos.end_time?(s(new Error("活动时间不得大于结束时间")),this.activity_infos.start_time=""):s())},s=null;return window.token&&(s=window.token),{action:"https://api.youjiemall.com/admin/api.seckill.activity.add",importHeaders:{"X-ADMIN-Authorization":s,"X-HH-Ver":Object({NODE_ENV:"production",VUE_APP_APPSERVER_HOST:"https://api.youjiemall.com",VUE_APP_HDSERVER_HOST:"https://hd.youjiemall.com",VUE_APP_JAVASERVER_HOST:"https://docker.youjiemall.com",VUE_APP_STORENAME:"有解",BASE_URL:"templates_vue/"}).VUE_APP_APPSERVER_VERSION},hasFile:!1,activity_infos:{secbuy_id:"",secbuy_name:"",start_time:"",end_time:""},pageSize:5,pageNumber:1,currentPage:1,total:0,goods_info:[],data_type:{sale:"",goods_number:"",sale_goods_number:"",check_zero:"",export_fail:"",param_error:"",money_error:"",sku_goods:"",discount_activity_shop_price:"",special_activity_shop_price:"",special_activity_money_line:"",goods_name:"",other_activity_running:"",seckill_casg:"",seckill_price:"",shop_seckill_cash:"",shop_seckill_price:""},secbuy_infos:{},addRules:{secbuy_name:[{required:!0,message:"请输入活动名称",trigger:"change"},{min:3,max:30,message:"活动名称长度3~30",trigger:"change"}],start_time:[{required:!0,message:"请选择开始时间",trigger:"blur"},{validator:e,trigger:"blur"}],end_time:[{required:!0,message:"请选择结束时间",trigger:"blur"},{validator:t,trigger:"blur"}]},fullscreenLoading:!0,submitLoading:!1,pageLoading:!1,notSave:!1,centerDialogVisible:!1,mutex0:!1,mutex1:!1,ProductList:localStorage.getItem("productlist")?JSON.parse(localStorage.getItem("productlist")):[]}},created(){this.isAdd||this.isProduct||(this.activity_infos.secbuy_id=this.$route.query.id,this.getActivityInfos()),this.isAdd&&(localStorage.clear(),this.goods_info=this.ProductList=[]),this.isProduct&&this.ProductList.length>0&&(this.ProductList.forEach(t=>{t.secbuy_close_price=t.cash_price,t.settlement_surplus=t.huanbi_price}),localStorage.setItem("productlist",JSON.stringify(this.ProductList)),this.goods_info=this.ProductList,this.mutex0=!0,this.mutex1=!0,this.pageLoading=!1)},computed:{isAdd(){return"add"===this.$route.query.operate},curStatus(){return 1===Number(this.$route.query.status)},isDisable(){return!this.isAdd&&this.curStatus},isValid(){let t=!1;return this.$refs["activityForm"].validate(e=>{t=e}),t},isLoading(){return this.fullscreenLoading&&!this.isAdd&&!this.isProduct},postParams(){let t=this.pageNumber,e=this.pageSize;var s,a,i;return this.isProduct?(s=1,i=0,a=localStorage.getItem("productlist")):s=0,Object(o["a"])({},this.activity_infos,{pageNumber:t,pageSize:e,is_select:s,productlist:a,secbuy_status:i})},isProduct(){return"productlist"===this.$route.query.operate}},methods:{getActivityInfos(){this.pageLoading=!0,Object(r["a"])(this.postParams).then(t=>{this.activity_infos=t.secbuy_info,this.activity_infos.start_time=this.utils.formatStamp(this.activity_infos.start_time,1),this.activity_infos.end_time=this.utils.formatStamp(this.activity_infos.end_time,1),this.goods_info=t.list,this.fullscreenLoading=!1,this.pageLoading=!1,this.isProduct?this.ProductList&&this.ProductList.length>0&&(this.goods_info=this.ProductList):this.total=t.total})},handleCurrentChange(){console.log("current page is ",this.currentPage),this.pageNumber=this.currentPage,this.getActivityInfos()},goEdit(t){this.$router.replace({name:"KillGoodEdit",params:{actID:this.activity_infos.secbuy_id,goodID:t}})},goRemove(t){this.$confirm("确定移除该商品吗","提示").then(()=>{this.pageLoading=!0,this.$api.delete("hd/itzSecbuyGoods?secbuy_goods_id=".concat(t),null,e=>{200==e.status&&Object(r["h"])(t).then(t=>{t&&(console.log(t),this.handleCurrentChange())})})})},sellNone(t){Object(r["k"])(t.id).then(e=>{e&&(this.$message.success("该商品下架成功"),t.is_on_sale=0)})},saveNewActivity(){if(this.isValid)if(this.isAdd)this.hasFile?(this.submitLoading=!0,this.$refs.uploadFile.submit()):this.$message.error("新增活动必须导入商品");else if(this.isProduct)if(console.log(this.postParams),this.postParams.productlist&&"[]"!=this.postParams.productlist){this.submitLoading=!1;var t=JSON.parse(localStorage.getItem("productlist")),e=[];t.forEach(t=>{let s={};s["quantity"]=t.secbuy_quantity,s["id"]=t.signup_id,e.push(s)}),console.log(e),this.$api.put("hd/itzSecbuyGoods",e,t=>{200==t.status&&(console.log(this.postParams),Object(r["c"])(this.postParams).then(t=>{if(t){console.log(t),this.data_type=t.data.data_type;for(let t in this.data_type)this.data_type[t].length>0&&(this.centerDialogVisible=!0,this.submitLoading=!1),this.data_type[t]=this.data_type[t].join();if(this.total=t.total,t.list.length<1)return void this.$confirm("保存失败,请移除问题商品之后重新保存","提示",{confirmButtonText:"确定",type:"warning"});this.submitLoading=!1,this.$message.success("保存成功"),localStorage.clear(),this.mutex0=!1,this.mutex1=!1,this.submitLoading=!1,this.goods_info=t.list,this.activity_infos=t.secbuy_info,this.activity_infos.start_time=this.utils.formatStamp(this.activity_infos.start_time,1),this.activity_infos.end_time=this.utils.formatStamp(this.activity_infos.end_time,1)}}))})}else this.$message.error("新增活动必须导入商品");else{if((new Date).getTime()>=this.activity_infos.start_time)return void this.$message.error("活动已经开始了");this.hasFile?(this.submitLoading=!0,this.$refs.uploadFile.submit()):(this.submitLoading=!0,Object(r["c"])(this.postParams).then(t=>{t&&(this.$message.success("保存成功"),this.submitLoading=!1)}))}},uploadSuccess(t){this.submitLoading=!1,this.$refs.uploadFile.clearFiles();let e=t.data;this.data_type=e.data.data_type;for(let s in this.data_type)this.data_type[s].length>0&&(this.centerDialogVisible=!0),this.data_type[s]=this.data_type[s].join();if(this.isAdd&&!this.centerDialogVisible&&(this.notSave=!0),this.total=e.total,t.code||0===e.list.length)return this.$message.error("保存失败,请重新导入商品"),void(this.hasFile=!1);this.$message.success("保存成功"),this.goods_info=e.list,this.submitLoading=!1,this.activity_infos=e.secbuy_info,this.activity_infos.start_time=this.utils.formatStamp(this.activity_infos.start_time,1),this.activity_infos.end_time=this.utils.formatStamp(this.activity_infos.end_time,1)},overFile(){this.$message.error("只能上传一个文件")},addFile(t){"ready"===t.status&&(this.hasFile=!0,this.mutex1=!1,this.mutex0=!1)},removeFile(){this.hasFile=!1,this.mutex1=!1,this.mutex0=!0},downloadTpl(){Object(r["l"])().then(t=>{Object(l["saveAs"])(new Blob([t.data]),t.filename)})},fmtMoney(t,e){return this.utils.formatMoney(t[e.property])},fmtPayType(t,e){let s=t[e.property];return n["a"].map(function(t){return t.type_id===s?t.type_name:void 0})},ChoiceOnline(){this.mutex1=!1,this.mutex0=!0;let t=this.$route.query.id?this.$route.query.id:"",e=this.$route.query.ststus?this.$route.query.status:"";this.$router.push({name:"ChoiceOnline",query:{id:t,status:e}})},goback(){localStorage.clear(),this.$router.replace({name:"SecondKill"})},Removepro(t){let e=this.ProductList.findIndex(e=>e.goods_id==t);this.ProductList.splice(e,1),this.postParams.productlist=this.ProductList,localStorage.setItem("productlist",JSON.stringify(this.ProductList)),console.log(this.ProductList.length),this.ProductList.length<1&&(this.mutex1=!1,this.mutex0=!1)}}}),u=c,d=(s("1937"),s("217b"),s("2877")),_=Object(d["a"])(u,a,i,!1,null,"7a0e9a0a",null);e["default"]=_.exports},cba1:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"container"},[s("div",{staticClass:"header"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",[t._v("有解商城管理中心")]),s("el-breadcrumb-item",[t._v("运营活动管理")]),s("el-breadcrumb-item",[t._v("限时促销")])],1)],1),s("div",{staticClass:"search-wrapper"},[s("el-form",{attrs:{inline:!0}},[s("el-row",{staticStyle:{"margin-right":"0"},attrs:{gutter:20}},[s("el-form-item",{attrs:{label:"活动名称"}},[s("el-input",{attrs:{placeholder:"活动名称",clearable:""},model:{value:t.params.secbuy_name,callback:function(e){t.$set(t.params,"secbuy_name",e)},expression:"params.secbuy_name"}})],1),s("el-form-item",{attrs:{label:"创建时间"}},[s("el-date-picker",{attrs:{type:"datetime",placeholder:"开始时间","value-format":"timestamp"},model:{value:t.params.create_start_time,callback:function(e){t.$set(t.params,"create_start_time",e)},expression:"params.create_start_time"}}),s("span",[t._v("  ~  ")]),s("el-date-picker",{attrs:{type:"datetime",placeholder:"结束时间","value-format":"timestamp"},model:{value:t.params.create_end_time,callback:function(e){t.$set(t.params,"create_end_time",e)},expression:"params.create_end_time"}})],1)],1),s("el-row",{staticStyle:{"margin-right":"0"},attrs:{gutter:20}},[s("el-form-item",{attrs:{label:"活动状态"}},[s("el-select",{attrs:{clearable:"",placeholder:"活动状态"},model:{value:t.params.secbuy_status,callback:function(e){t.$set(t.params,"secbuy_status",e)},expression:"params.secbuy_status"}},t._l(t.statusList,function(t){return s("el-option",{key:t.status_id,attrs:{label:t.status_name,value:t.status_id}})}),1)],1),s("el-form-item",{attrs:{label:"活动形式"}},[s("el-select",{attrs:{clearable:"",filterable:"",placeholder:"活动形式"},model:{value:t.params.type,callback:function(e){t.$set(t.params,"type",e)},expression:"params.type"}},t._l(t.typeList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getActivityList}},[t._v("\n            搜索\n          ")]),s("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.clearSearchParams}},[t._v("\n            清空\n          ")]),s("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.addNewActivity}},[t._v("\n            创建活动\n          ")])],1)],1)],1)],1),s("div",{staticClass:"list-wrapper"},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.activityList,stripe:"",border:"","header-cell-style":{background:"#eef1f6"}}},[s("el-table-column",{attrs:{prop:"secbuy_id",label:"编号"}}),s("el-table-column",{attrs:{prop:"secbuy_name",label:"活动名称","min-width":"200%","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{prop:"type",label:"活动形式",formatter:t.fmtType}}),s("el-table-column",{attrs:{label:"活动时间","min-width":"300%","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",[t._v(t._s(t.timeStampFmt(e.row,"start_time")))]),t._v("\n            至  \n          "),s("span",[t._v(t._s(t.timeStampFmt(e.row,"end_time")))])]}}])}),s("el-table-column",{attrs:{prop:"created_at",label:"创建时间","min-width":"180px",formatter:t.timeStampFmt,"show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{prop:"secbuy_status",label:"活动状态",formatter:t.statusFmt}}),s("el-table-column",{attrs:{label:"操作","min-width":"150%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goActivityUrl(e.row.secbuy_id)}}},[t._v("\n            链接\n          ")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goDetail(e.row.secbuy_id)}}},[t._v("\n            查看\n          ")]),0===e.row.secbuy_status||1===e.row.secbuy_status||3===e.row.secbuy_status?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goEdit(e.row)}}},[t._v("\n            编辑\n          ")]):t._e(),0===e.row.secbuy_status||3===e.row.secbuy_status?s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goRemove(e.row.secbuy_id)}}},[t._v("\n            删除\n          ")]):t._e()]}}])})],1)],1),s("el-pagination",{attrs:{"current-page":t.params.pageNumber,background:"",layout:"prev, pager, next, jumper",total:t.total,"hide-on-single-page":!0},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.params,"pageNumber",e)},"update:current-page":function(e){return t.$set(t.params,"pageNumber",e)}}}),s("el-dialog",{attrs:{title:"活动链接",visible:t.showUrl,width:"50%"},on:{"update:visible":function(e){t.showUrl=e}}},[s("div",{staticClass:"url-info"},[t._v(t._s(t.urlInfo))]),s("div",{staticClass:"btn-box"},[s("el-button",{on:{click:function(e){t.showUrl=!1}}},[t._v("取消")]),s("el-button",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.urlInfo,expression:"urlInfo",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],attrs:{type:"primary"}},[t._v("复制")])],1)])],1)},i=[],o=(s("097d"),s("873b")),r=s("3b8b"),l={name:"SecondKill",data(){return{params:{pageNumber:1,pageSize:10,secbuy_name:"",start_time:"",end_time:"",create_start_time:"",create_end_time:"",secbuy_status:"",type:"",activity_type:1},total:0,activityList:[],statusList:o["c"],typeList:o["a"],loading:!1,showUrl:!1,urlInfo:""}},created(){this.getActivityList()},computed:{fmtParams(){let t=JSON.parse(JSON.stringify(this.params));for(let e in t)e.endsWith("_time")&&t[e]&&(t[e]=this.utils.formatStamp(t[e]));return""===t.type&&(t.type=0),t}},methods:{getActivityList(){this.loading=!0,Object(r["b"])(this.fmtParams).then(t=>{this.activityList=t.data,this.total=t.total}).finally(()=>{this.loading=!1})},clearSearchParams(){for(let t in this.params)this.params[t]="";this.params.pageNumber=1,this.params.pageSize=10,this.getActivityList()},addNewActivity(){this.$router.push({name:"PromoteSaleAdd",query:{operate:"add"}})},goDetail(t){this.$router.push({name:"PromoteSaleDetail",params:{id:t}})},goEdit(t){this.$router.push({name:"PromoteSaleAdd",query:{id:t.secbuy_id,status:t.secbuy_status}})},goActivityUrl(t){this.urlInfo="https://m.huanhuanyiwu.com/h5/#/promotionList/"+t,this.showUrl=!0},onCopy(t){this.$message.success("复制成功"),this.showUrl=!1},onError(t){this.$message.error("复制失败")},goRemove(t){this.$confirm("确定删除该活动吗？","提示").then(()=>{this.loading=!0,Object(r["d"])(t).then(t=>{t&&(this.$message.success("删除成功"),this.getActivityList())})})},timeStampFmt(t,e){let s="string"===typeof e?e:e.property,a=t[s];return a?this.utils.formatDate("YYYY-MM-DD HH:mm:ss",this.utils.formatStamp(a,1)):a},fmtType(t,e,s){let a="";return this.typeList.forEach(t=>{t.id==s&&(a=t.name)}),a},statusFmt(t,e,s){let a="";return this.statusList.forEach(t=>{t.status_id==s&&(a=t.status_name)}),a},handleCurrentChange(){this.getActivityList()}}},n=l,c=(s("2f40"),s("2877")),u=Object(c["a"])(n,a,i,!1,null,"5fa88289",null);e["default"]=u.exports},dc6f:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:t.isLoading,expression:"isLoading",modifiers:{fullscreen:!0,lock:!0}}],staticClass:"container"},[s("div",{staticClass:"header"},[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",[t._v("有解商城管理中心")]),s("el-breadcrumb-item",[t._v("运营活动管理")]),s("el-breadcrumb-item",[t._v("\n        "+t._s(t.isAdd?"新增活动":"活动编辑")+"\n      ")])],1)],1),s("div",{staticClass:"activity-info-wrapper"},[s("el-form",{ref:"activityForm",attrs:{"label-width":"120px",rules:t.addRules,model:t.activity_infos}},[s("el-form-item",{attrs:{label:"活动名称",prop:"secbuy_name"}},[s("el-input",{attrs:{placeholder:"请输入活动名称",clearable:"",disabled:t.isDisable},model:{value:t.activity_infos.secbuy_name,callback:function(e){t.$set(t.activity_infos,"secbuy_name",e)},expression:"activity_infos.secbuy_name"}}),s("span",{staticClass:"tip-info"},[t._v("最多20个字符")])],1),s("el-form-item",{attrs:{label:"活动形式"}},[s("p",[s("el-radio",{attrs:{label:1,disabled:t.createandimport},model:{value:t.activity_infos.type,callback:function(e){t.$set(t.activity_infos,"type",e)},expression:"activity_infos.type"}},[t._v("积分专享")])],1),s("p",[s("el-radio",{attrs:{label:2,disabled:t.createandimport},model:{value:t.activity_infos.type,callback:function(e){t.$set(t.activity_infos,"type",e)},expression:"activity_infos.type"}},[t._v("限时折扣")])],1),2==t.activity_infos.type?[s("p",[s("label",{staticClass:"el-form-item__label"},[t._v("折扣是否在前台显示")]),s("el-switch",{attrs:{"active-value":1,"inactive-value":0,disabled:t.isDisable},model:{value:t.activity_infos.is_show_discount,callback:function(e){t.$set(t.activity_infos,"is_show_discount",e)},expression:"activity_infos.is_show_discount"}})],1),t.activity_infos.is_show_discount?s("p",[s("label",{staticClass:"el-form-item__label"},[t._v("折扣底色")]),s("el-input",{attrs:{placeholder:"手动输入颜色，十六进制",clearable:"",disabled:t.isDisable},model:{value:t.activity_infos.discount_colour,callback:function(e){t.$set(t.activity_infos,"discount_colour",e)},expression:"activity_infos.discount_colour"}}),s("colorPicker",{attrs:{disabled:t.isDisable},model:{value:t.activity_infos.discount_colour,callback:function(e){t.$set(t.activity_infos,"discount_colour",e)},expression:"activity_infos.discount_colour"}})],1):t._e()]:t._e()],2),s("el-form-item",{attrs:{label:"标签名称",prop:"tags_name"}},[s("el-input",{attrs:{placeholder:"请输入标签名称",clearable:"",disabled:t.isDisable},model:{value:t.activity_infos.tags_name,callback:function(e){t.$set(t.activity_infos,"tags_name",e)},expression:"activity_infos.tags_name"}}),s("span",{staticClass:"tip-info"},[t._v("最多5个字符")])],1),s("el-form-item",{attrs:{label:"标签底色",prop:"tags_colour"}},[s("el-input",{attrs:{placeholder:"手动输入颜色，十六进制",clearable:"",disabled:t.isDisable},model:{value:t.activity_infos.tags_colour,callback:function(e){t.$set(t.activity_infos,"tags_colour",e)},expression:"activity_infos.tags_colour"}}),s("colorPicker",{attrs:{disabled:t.isDisable},model:{value:t.activity_infos.tags_colour,callback:function(e){t.$set(t.activity_infos,"tags_colour",e)},expression:"activity_infos.tags_colour"}})],1),s("el-form-item",{attrs:{label:"活动时间"}},[s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{prop:"start_time"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"活动开始时间","value-format":"timestamp","default-time":"00:00:00",disabled:t.isDisable},model:{value:t.activity_infos.start_time,callback:function(e){t.$set(t.activity_infos,"start_time",e)},expression:"activity_infos.start_time"}})],1)],1),s("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:1}},[t._v("-")]),s("el-col",{attrs:{span:5}},[s("el-form-item",{attrs:{prop:"end_time"}},[s("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"活动结束时间","value-format":"timestamp","default-time":"23:59:59",disabled:t.isDisable},model:{value:t.activity_infos.end_time,callback:function(e){t.$set(t.activity_infos,"end_time",e)},expression:"activity_infos.end_time"}})],1)],1)],1),s("el-form-item",{attrs:{label:"适用人群"}},[s("p",[s("el-radio",{attrs:{label:0,disabled:t.isDisable},model:{value:t.activity_infos.range,callback:function(e){t.$set(t.activity_infos,"range",e)},expression:"activity_infos.range"}},[t._v("换换全部用户")])],1),s("p",[s("el-radio",{attrs:{label:1,disabled:t.isDisable},model:{value:t.activity_infos.range,callback:function(e){t.$set(t.activity_infos,"range",e)},expression:"activity_infos.range"}},[t._v("换换新用户")])],1),s("p",[s("el-radio",{attrs:{label:2,disabled:t.isDisable},model:{value:t.activity_infos.range,callback:function(e){t.$set(t.activity_infos,"range",e)},expression:"activity_infos.range"}},[t._v("爱投资全部用户")])],1)])],1)],1),s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.submitLoading,expression:"submitLoading"}],staticClass:"goods-list-wrapper"},[s("div",{staticClass:"import-good-wrapper"},[s("span",[t._v("*")]),s("label",[t._v("导入商品")]),s("el-upload",{ref:"uploadFile",attrs:{headers:t.importHeaders,action:t.action,data:t.fmtParams,name:"myfile","auto-upload":!1,"on-success":t.uploadSuccess,"on-change":t.addFile,"before-remove":t.removeFile,limit:1,"on-exceed":t.overFile}},[s("el-button",{attrs:{type:"primary",disabled:t.isDisable}},[t._v("导入商品")])],1),s("el-button",{staticClass:"tpl-download",attrs:{type:"text",disabled:t.isDisable},on:{click:t.downloadTpl}},[t._v("模板下载")])],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],staticStyle:{width:"100%"},attrs:{data:t.goods_info,stripe:"",border:"","header-cell-style":{background:"#eef1f6"}}},[s("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),s("el-table-column",{attrs:{label:"商品ID",prop:"goods_id"}}),s("el-table-column",{attrs:{label:"商品名称",prop:"goods_name","min-width":"300%","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{label:"所属商家",prop:"shop_name","min-width":"200%","show-overflow-tooltip":!0}}),s("el-table-column",{attrs:{label:"可售库存",prop:"goods_number"}}),s("el-table-column",{attrs:{label:"活动限购数量",prop:"secbuy_quantity","min-width":"120%"}}),s("el-table-column",{attrs:{label:"促销现金结算价",prop:"secbuy_close_price","min-width":"120%",formatter:t.fmtMoney}}),s("el-table-column",{attrs:{label:"促销积分结算价",prop:"settlement_surplus","min-width":"120%",formatter:t.fmtMoney}}),s("el-table-column",{attrs:{label:"原价","min-width":"200%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.goods_shop_price)))]),s("p",[t._v("\n            "+t._s("(现金:"+t.utils.formatMoney(e.row.goods_cash)+" + 积分:"+t.utils.formatMoney(e.row.goods_money_line)+")")+"\n          ")])]}}])}),s("el-table-column",{attrs:{label:"促销价","min-width":"200%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("p",[t._v(t._s(t.utils.formatMoney(e.row.shop_price)))]),s("p",[t._v("\n            "+t._s("(现金:"+t.utils.formatMoney(e.row.cash_price)+" + 积分:"+t.utils.formatMoney(e.row.huanbi_price)+")")+"\n          ")])]}}])}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.curStatus?s("div",[s("el-button",{attrs:{type:"text",size:"small",disabled:!e.row.is_on_sale},on:{click:function(s){return t.sellNone(e.row)}}},[t._v("售罄")])],1):s("div",[s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goEdit(e.row.id)}}},[t._v("\n              编辑\n            ")]),s("el-button",{attrs:{type:"text",size:"small"},on:{click:function(s){return t.goRemove(e.row.id)}}},[t._v("\n              移除\n            ")])],1)]}}])})],1)],1),s("el-pagination",{attrs:{"current-page":t.pageNumber,background:"",layout:"prev, pager, next, jumper","page-size":t.pageSize,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.pageNumber=e},"update:current-page":function(e){t.pageNumber=e}}}),s("div",{staticClass:"btn-groups-wrapper"},[s("el-button",{attrs:{type:""},on:{click:t.goback}},[t._v("取消")]),s("el-button",{attrs:{type:"primary",disabled:t.notSave},on:{click:t.saveNewActivity}},[t._v("确定")])],1),s("div",{staticClass:"error-good-info-wrapper"},[s("el-dialog",{attrs:{visible:t.centerDialogVisible,width:"50%","show-close":!1},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[s("div",{attrs:{slot:"title"},slot:"title"},[t._v("导入商品提示")]),s("div",[s("div",[t.data_type.sale?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("已下架")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.sale))])],1):t._e(),t.data_type.goods_number?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("已售罄")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.goods_number))])],1):t._e(),t.data_type.sale_goods_number?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("售罄并下架")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.sale_goods_number))])],1):t._e(),t.data_type.check_zero?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("未审核")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.check_zero))])],1):t._e(),t.data_type.export_fail?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("导入失败")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.export_fail))])],1):t._e(),t.data_type.param_error?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("数据错误")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.param_error))])],1):t._e(),t.data_type.money_error?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("金额错误")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.money_error))])],1):t._e(),t.data_type.sku_goods?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("多规格SKU")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.sku_goods))])],1):t._e(),t.data_type.seckill_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("设置的秒杀价不能高于本店售价")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.seckill_price))])],1):t._e(),t.data_type.seckill_casg?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("设置的秒杀现金价不能高于本店售价中的现金价")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.seckill_casg))])],1):t._e(),t.data_type.shop_seckill_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("售价 - 促销价需大于等于 1")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.shop_seckill_price))])],1):t._e(),t.data_type.shop_seckill_cash?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("售价现金价 - 促销现金价需大于等于 1")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.shop_seckill_cash))])],1):t._e(),t.data_type.goods_name?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("商品编号与商品名称不一致，请修改后重新提交。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.goods_name))])],1):t._e(),t.data_type.discount_activity_shop_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("限时折扣活动价要低于本店售价。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.discount_activity_shop_price))])],1):t._e(),t.data_type.special_activity_shop_price?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("积分专享活动价不等于本店售价。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.special_activity_shop_price))])],1):t._e(),t.data_type.special_activity_money_line?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("积分专享抵扣上限小于默认权限抵扣上限。")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.special_activity_money_line))])],1):t._e(),t.data_type.other_activity_running?s("el-row",{attrs:{gutter:22}},[s("el-col",{attrs:{span:3}},[t._v("状态:")]),s("el-col",{staticClass:"word-style",attrs:{span:9}},[t._v("已参与其他活动")]),s("el-col",{attrs:{span:4}},[t._v("商品编号:")]),s("el-col",{staticClass:"over-hid",attrs:{span:8}},[t._v(t._s(t.data_type.other_activity_running))])],1):t._e(),s("p",[t._v("请仔细核对商品信息后重新上传失败数据")])],1)]),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary"},on:{click:function(e){t.centerDialogVisible=!1}}},[t._v("确 定")])],1)])],1)],1)},i=[],o=(s("097d"),s("a481"),s("be94")),r=s("3b8b"),l=s("21a6"),n=s("873b"),c=(s("2f62"),{name:"SecondKillAdd",data(){let t=(t,e,s)=>{""!==e&&(""!==this.activity_infos.start_time&&e<=this.activity_infos.start_time?(s(new Error("结束时间不能小于开始时间")),this.activity_infos.end_time=""):s())},e=(t,e,s)=>{""!==e&&(""!==this.activity_infos.end_time&&e>=this.activity_infos.end_time?(s(new Error("活动时间不得大于结束时间")),this.activity_infos.start_time=""):s())},s=null;return window.token&&(s=window.token),{action:"https://api.youjiemall.com/admin/api.seckill.activity.add",importHeaders:{"X-ADMIN-Authorization":s,"X-HH-Ver":Object({NODE_ENV:"production",VUE_APP_APPSERVER_HOST:"https://api.youjiemall.com",VUE_APP_HDSERVER_HOST:"https://hd.youjiemall.com",VUE_APP_JAVASERVER_HOST:"https://docker.youjiemall.com",VUE_APP_STORENAME:"有解",BASE_URL:"templates_vue/"}).VUE_APP_APPSERVER_VERSION},hasFile:!1,activity_infos:{secbuy_id:"",type:1,secbuy_name:"",tags_name:"",tags_colour:"#000000",start_time:"",end_time:"",range:0,discount_colour:"#000000",is_show_discount:0},pageNumber:1,pageSize:5,total:0,goods_info:[],data_type:{sale:"",goods_number:"",sale_goods_number:"",check_zero:"",export_fail:"",param_error:"",money_error:"",sku_goods:"",discount_activity_shop_price:"",special_activity_shop_price:"",special_activity_money_line:"",goods_name:"",other_activity_running:"",seckill_casg:"",seckill_price:"",shop_seckill_cash:"",shop_seckill_price:""},secbuy_infos:{},addRules:{secbuy_name:[{required:!0,message:"请输入活动名称",trigger:"change"},{min:3,max:20,message:"活动名称长度3~20",trigger:"change"}],tags_name:[{required:!0,message:"请输入标签名称",trigger:"change"},{max:5,message:"标签名称长度过长",trigger:"change"}],tags_colour:[{required:!0,message:"请选择标签颜色",trigger:"change"}],start_time:[{required:!0,message:"请选择开始时间",trigger:"blur"},{validator:e,trigger:"blur"}],end_time:[{required:!0,message:"请选择结束时间",trigger:"blur"},{validator:t,trigger:"blur"}]},fullscreenLoading:!0,submitLoading:!1,pageLoading:!1,notSave:!1,centerDialogVisible:!1}},computed:{isAdd(){return"add"===this.$route.query.operate},curStatus(){return 1===Number(this.$route.query.status)},isDisable(){return!this.isAdd&&this.curStatus},isValid(){let t=!1;return this.$refs["activityForm"].validate(e=>{t=e}),t},isLoading(){return this.fullscreenLoading&&!this.isAdd},fmtParams(){let t=JSON.parse(JSON.stringify(this.activity_infos));t.start_time=t.start_time/1e3,t.end_time=t.end_time/1e3;let e=this.pageNumber,s=this.pageSize;return Object(o["a"])({},t,{pageNumber:e,pageSize:s})},createandimport(){return!this.isAdd&&this.goods_info.length>0}},created(){this.isAdd||(this.activity_infos.secbuy_id=this.$route.query.id,this.getActivityInfos())},methods:{getActivityInfos(){this.pageLoading=!0,Object(r["a"])(this.fmtParams).then(t=>{this.activity_infos=t.secbuy_info,this.goods_info=t.list,this.fullscreenLoading=!1,this.pageLoading=!1,this.total=t.total,this.activity_infos.start_time=this.utils.formatStamp(this.activity_infos.start_time,1),this.activity_infos.end_time=this.utils.formatStamp(this.activity_infos.end_time,1)})},handleCurrentChange(){this.getActivityInfos()},goEdit(t){this.$router.replace({name:"PromoteSaleGoodEdit",params:{actID:this.activity_infos.secbuy_id,goodID:t}})},goRemove(t){this.$confirm("确定移除该商品吗","提示").then(()=>{this.pageLoading=!0,Object(r["h"])(t).then(t=>{t&&this.handleCurrentChange()})})},sellNone(t){Object(r["k"])(t.id).then(e=>{e&&(this.$message.success("该商品下架成功"),t.is_on_sale=0)})},saveNewActivity(){if(this.isValid)if(this.isAdd)this.hasFile?(this.submitLoading=!0,this.$refs.uploadFile.submit()):this.$message.error("新增活动必须导入商品");else{if((new Date).getTime()>=this.activity_infos.start_time)return void this.$message.error("活动已经开始了");this.hasFile?(this.submitLoading=!0,this.$refs.uploadFile.submit()):(this.submitLoading=!0,Object(r["j"])(this.fmtParams).then(t=>{t&&this.$message.success("保存成功")}).finally(()=>{this.submitLoading=!1}))}},uploadSuccess(t){this.submitLoading=!1,this.$refs.uploadFile.clearFiles();let e=t.data;this.data_type=e.data.data_type;for(let s in this.data_type)this.data_type[s].length>0&&(this.centerDialogVisible=!0),this.data_type[s]=this.data_type[s].join();if(this.isAdd&&!this.centerDialogVisible&&(this.notSave=!0),this.total=e.total,t.code||0===e.list.length)return this.$message.error("保存失败,请重新导入商品"),void(this.hasFile=!1);this.$message.success("保存成功"),this.goods_info=e.list,this.submitLoading=!1,this.activity_infos=e.secbuy_info,this.activity_infos.start_time=1e3*this.activity_infos.start_time,this.activity_infos.end_time=1e3*this.activity_infos.end_time},overFile(){this.$message.error("只能上传一个文件")},addFile(t){"ready"===t.status&&(this.hasFile=!0)},removeFile(){this.hasFile=!1},downloadTpl(){Object(r["l"])().then(t=>{Object(l["saveAs"])(new Blob([t.data]),t.filename)})},fmtMoney(t,e){return this.utils.formatMoney(t[e.property])},fmtPayType(t,e){let s=t[e.property];return n["b"].map(function(t){return t.type_id===s?t.type_name:void 0})},goback(){this.$router.replace({name:"PromoteSaleList"})}}}),u=c,d=(s("8f78"),s("e4b4"),s("2877")),_=Object(d["a"])(u,a,i,!1,null,"9cfc7304",null);e["default"]=_.exports},e4b4:function(t,e,s){"use strict";var a=s("5e1b"),i=s.n(a);i.a},f644:function(t,e,s){}}]);
//# sourceMappingURL=SecondKill.61590512.js.map