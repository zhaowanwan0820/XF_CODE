(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-295164fb"],{"6b9b":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("page-title",{attrs:{"first-title":"线上选品"}}),s("div",{staticClass:"search-wrapper"},[s("el-tabs",{attrs:{type:"card"}},e._l(e.retailState,function(t){return s("el-tab-pane",{key:t.id,attrs:{label:t.label}},[s("span",{attrs:{slot:"label"},slot:"label"},[e._v(e._s(t.label)+"\n          "),s("span",{directives:[{name:"show",rawName:"v-show",value:"2"==t.id,expression:"item.id == '2'"}]},[e._v("( "+e._s(e.checklist.length)+" )")])]),s("el-form",{directives:[{name:"show",rawName:"v-show",value:"1"==t.id,expression:"item.id == '1'"}],staticClass:"demo-form-inline",attrs:{inline:!0,model:e.params}},[s("el-form-item",{attrs:{label:"商品编号"}},[s("el-input",{attrs:{placeholder:"商品编号",clearable:""},model:{value:e.params.goods_id,callback:function(t){e.$set(e.params,"goods_id",t)},expression:"params.goods_id"}})],1),s("el-form-item",{attrs:{label:"报名主题"}},[s("el-select",{staticStyle:{display:"block"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.params.signup_id,callback:function(t){e.$set(e.params,"signup_id",t)},expression:"params.signup_id"}},e._l(e.options1,function(e){return s("el-option",{key:e.id,attrs:{label:e.secName,value:e.id}})}),1)],1),s("el-form-item",{attrs:{label:"商品分类"}},[s("el-select",{staticStyle:{display:"block"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.params.category_id,callback:function(t){e.$set(e.params,"category_id",t)},expression:"params.category_id"}},e._l(e.options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),s("el-form-item",{attrs:{label:"所属店铺"}},[s("el-select",{staticStyle:{display:"block"},attrs:{filterable:"",clearable:"",placeholder:"请选择"},model:{value:e.params.suppliers_id,callback:function(t){e.$set(e.params,"suppliers_id",t)},expression:"params.suppliers_id"}},e._l(e.options2,function(e){return s("el-option",{key:e.suppliersId,attrs:{label:e.suppliersName,value:e.suppliersId}})}),1)],1),s("el-form-item",[s("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v("搜索")]),s("el-button",{attrs:{type:"primary",icon:"el-icon-refresh-left"},on:{click:e.clear}},[e._v("清空")])],1)],1),s("div",{staticClass:"list-wrapper"},[s("p",{staticClass:"red"},[e._v("填写秒杀库存之后的商品可选择，每人限购值为“0”代表不限购")]),s("el-table",{ref:"1"==t.id?"tableData":"",refInFor:!0,staticStyle:{width:"100%"},attrs:{data:"1"==t.id?e.list:e.checklist,"tooltip-effect":"dark","header-cell-style":{background:"#eef1f6"},"row-key":e.getRowKeys},on:{select:function(s){var a=arguments.length,r=Array(a);while(a--)r[a]=arguments[a];return e.checked.apply(void 0,r.concat([t.id]))},"select-all":function(s){var a=arguments.length,r=Array(a);while(a--)r[a]=arguments[a];return e.checkAll.apply(void 0,r.concat([t.id]))},"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"30",selectable:e.checkboxT,"reserve-selection":!0}}),s("el-table-column",{attrs:{prop:"goods_id",label:"商品编号"}}),s("el-table-column",{attrs:{prop:"goods_name",label:"商品名称"}}),s("el-table-column",{attrs:{prop:"goods_number",label:"可售库存"}}),s("el-table-column",{attrs:{prop:"surplus_quantity",label:"秒杀可售库存",sortable:""}}),s("el-table-column",{attrs:{label:"秒杀库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.row.secbuy_quantity,expression:"scope.row.secbuy_quantity",modifiers:{number:!0}}],staticClass:"nums",attrs:{type:"number"},domProps:{value:t.row.secbuy_quantity},on:{blur:[function(s){return e.changeNum(t.row,0)},function(t){return e.$forceUpdate()}],input:function(s){s.target.composing||e.$set(t.row,"secbuy_quantity",e._n(s.target.value))}}}),s("p",{staticClass:"red"},[e._v(e._s(t.row.number1))])]}}],null,!0)}),s("el-table-column",{attrs:{label:"每人限购"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.row.max_quantity,expression:"scope.row.max_quantity",modifiers:{number:!0}}],staticClass:"nums",attrs:{type:"number"},domProps:{value:t.row.max_quantity},on:{blur:[function(s){return e.changeNum(t.row,2)},function(t){return e.$forceUpdate()}],input:function(s){s.target.composing||e.$set(t.row,"max_quantity",e._n(s.target.value))}}}),s("p",{staticClass:"red"},[e._v(e._s(t.row.number1))])]}}],null,!0)}),s("el-table-column",{attrs:{label:"排序值"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("input",{directives:[{name:"model",rawName:"v-model.number",value:t.row.goods_order,expression:"scope.row.goods_order",modifiers:{number:!0}}],staticClass:"nums",attrs:{type:"number",min:1,max:100},domProps:{value:t.row.goods_order},on:{blur:[function(s){return e.changeNum(t.row.goods_order,1)},function(t){return e.$forceUpdate()}],input:function(s){s.target.composing||e.$set(t.row,"goods_order",e._n(s.target.value))}}}),s("p",{staticClass:"red"},[e._v(e._s(t.row.number2))])]}}],null,!0)}),s("el-table-column",{attrs:{label:"原价"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("p",[e._v(e._s(e.utils.formatMoney(t.row.goods_shop_price)))]),s("p",[e._v("\n                  "+e._s("(现金价:"+e.utils.formatMoney(t.row.goods_cash)+" + 积分支付上限:"+e.utils.formatMoney(t.row.goods_money_line)+")")+"\n                ")])]}}],null,!0)}),s("el-table-column",{attrs:{prop:"shop_price",label:"秒杀总价",sortable:""}}),s("el-table-column",{attrs:{prop:"cash_price",label:"秒杀现金价"}}),s("el-table-column",{attrs:{prop:"huanbi_price",label:"秒杀积分上限"}}),s("el-table-column",{attrs:{prop:"shop_name",label:"所属店铺"}}),s("el-table-column",{attrs:{prop:"signup_discount",label:"秒杀折扣",formatter:e.forscale,sortable:""}}),s("el-table-column",{attrs:{prop:"signup_proportion",label:"积分比例",formatter:e.forscale,sortable:""}}),s("el-table-column",{attrs:{prop:"signup_frequency",label:"参与秒杀次数",sortable:""}}),s("el-table-column",{attrs:{prop:"signup_sales",label:"秒杀累计销量",sortable:""}}),s("el-table-column",{attrs:{prop:"project_sales",label:"商品销量",sortable:""}})],1)],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"1"!=t.id,expression:"item.id != '1'"}],staticStyle:{"margin-top":"20px"}},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.deleteItem}},[e._v("删除")])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"1"==t.id,expression:"item.id == '1'"}]},[s("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.params.limit,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}}),s("div",{staticClass:"btn-box"},[s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.submitcheck}},[e._v("提交")]),s("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.canlecheck}},[e._v("取消")])],1)],1)],1)}),1)],1)],1)},r=[],i=(s("a481"),{name:"RetailSupplierList",data(){return{getRowKeys(e){return e.goods_id},list:[],options:[],options1:[],options2:[],checklist:[],currentPage:1,retailState:[{label:"全部",id:"1"},{label:"已选中",id:"2"}],params:{page:1,limit:6,signup_id:"",goods_id:"",category_id:"",suppliers_id:"",secbuy_id:this.$route.query.id?this.$route.query.id:""},total:0,multipleSelection:[],checkable:!0,deleteArr:[],hodeArr:[]}},created(){this.gettypeList()},methods:{changeNum(e,t){0==t?e.secbuy_quantity>e.surplus_quantity?this.$message.error("秒杀库存不能大于秒杀可售库存"):e.secbuy_quantity<1&&this.$message.error("秒杀库存不能小于1"):1==t&&((e>100||e<1)&&(this.$message.error("排序值取值范围为1-100"),e=100),e.length>3&&(e=e.splice(0,3)))},handleSelectionChange(e){this.multipleSelection=e,this.select_order_number=this.multipleSelection.length,this.select_orderId=[],e&&e.forEach(e=>{e&&this.select_orderId.push(e.orderid)})},gettypeList(){this.$api.get("hd/itzSecbuyGoods/selection",null,e=>{200==e.status&&(this.options=e.data.category,this.options1=e.data.signupNames,this.options2=e.data.suppliers)})},search(){this.params.page=1,this.params.signup_id?this.getList():this.$message.error("请选择报名主题")},getList(){this.$api.get("hd/itzSecbuyGoods",this.params,e=>{200==e.status?e.data.total>0?(this.list=e.data.rows,this.total=e.data.total,this.checklist.length>0&&this.checklist.forEach(e=>{this.list.forEach((t,s)=>{t.goods_id==e.goods_id&&(this.list[s]=e)})})):this.$confirm("该报名主题下暂时没有候选商品","提示",{confirmButtonText:"确定",type:"warning"}):(this.list={},this.$message.error(e.msg))})},handleCurrentChange(e){this.params.page=e,this.getList()},dateFormat:function(e,t){let s=e[t.property];return s?this.utils.formatDate("YYYY-MM-DD HH:mm:ss",1e3*s):s},forscale:function(e,t){let s=e[t.property];return s?s+"%":""},clear(){this.params.page=1,this.params.limit=6,this.params.signup_id="",this.params.goods_id="",this.params.category_id="",this.params.suppliers_id=""},pricehistory(e){let t=this.list.findIndex(t=>t.goodsId==e);localStorage.setItem("msg",JSON.stringify(this.list[t])),this.$router.push({name:"PriceHistory",params:{id:e}})},checkboxT(e){return!!e.secbuy_quantity},checked(e,t,s){if("1"==s){var a=e.length&&-1!==e.indexOf(t);a?this.$api.put("hd/itzSecbuySignupGoods/goods/lock/".concat(t.signup_id),null,e=>{},e=>{console.log("失败"),this.$confirm("".concat(e.message),"提示",{confirmButtonText:"确定"}),this.$refs.tableData[0].toggleRowSelection(t)}):this.$api.put("hd/itzSecbuySignupGoods/goods/unlock/".concat(t.signup_id),null,e=>{},e=>{this.$confirm("".concat(e.message),"提示",{confirmButtonText:"确定"}),this.$refs.tableData[0].toggleRowSelection(t)}),this.checklist=e}else this.deleteArr=e},checkAll(e,t){if("1"==t){var s=[];e.length>0?(e.forEach(e=>{s.push(e.signup_id)}),this.$api.put("hd/itzSecbuySignupGoods/goods/lock/",s,e=>{if(200==e.status&&e.data&&e.data.length>0){this.$confirm("".concat(e.message),"提示",{confirmButtonText:"确定"});var t=[],s={};e.data.forEach(e=>{s=this.list.find(t=>{return t.signup_id==e}),t.push(s)}),t.forEach(e=>{this.$refs.tableData[0].toggleRowSelection(e)})}})):(this.list.forEach(e=>{e.secbuy_quantity&&s.push(e.signup_id)}),this.$api.put("hd/itzSecbuySignupGoods/goods/unlock/",s,e=>{})),this.checklist=e}else this.deleteArr=e},canlecheck(){localStorage.clear(),this.$router.go(-1)},submitcheck(){if(this.checklist.length>0){this.checklist.forEach(e=>{return e.goods_order?e.goods_order:e.goods_order=100}),localStorage.setItem("productlist",JSON.stringify(this.checklist));let e=this.$route.query.id,t=this.$route.query.status;this.$router.replace({name:"SecondKillAdd",query:{operate:"productlist",id:e,status:t}})}else this.$confirm("请选择商品后再提交","提示",{confirmButtonText:"确定",type:"warning"})},deleteItem(){for(var e=this.checklist,t=this.deleteArr,s=[],a=0;a<t.length;a++){s.push(t[a].signup_id);for(var r=0;r<e.length;r++)e[r]===t[a]&&(e.splice(r,1),r--)}this.checklist=e,this.$api.put("hd/itzSecbuySignupGoods/goods/unlock/",s,e=>{})}}}),l=i,o=(s("6bd1"),s("2877")),n=Object(o["a"])(l,a,r,!1,null,"04dbda9a",null);t["default"]=n.exports},"6bd1":function(e,t,s){"use strict";var a=s("f1d9"),r=s.n(a);r.a},f1d9:function(e,t,s){}}]);
//# sourceMappingURL=chunk-295164fb.10f395a7.js.map