(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1d15d187"],{"097d":function(t,e,a){"use strict";var n=a("5ca1"),i=a("8378"),s=a("7726"),o=a("ebd6"),l=a("bcaa");n(n.P+n.R,"Promise",{finally:function(t){var e=o(this,i.Promise||s.Promise),a="function"==typeof t;return this.then(a?function(a){return l(e,t()).then(function(){return a})}:t,a?function(a){return l(e,t()).then(function(){throw a})}:t)}})},"21a6":function(t,e,a){(function(a){var n,i,s;(function(a,o){i=[],n=o,s="function"===typeof n?n.apply(e,i):n,void 0===s||(t.exports=s)})(0,function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function n(t,e,a){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){l(n.response,e,a)},n.onerror=function(){console.error("could not download file")},n.send()}function i(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,l=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(t,e,a){var l=o.URL||o.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener","string"==typeof t?(r.href=t,r.origin===location.origin?s(r):i(r.href)?n(t,e,a):s(r,r.target="_blank")):(r.href=l.createObjectURL(t),setTimeout(function(){l.revokeObjectURL(r.href)},4e4),setTimeout(function(){s(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,a,o){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,o),a);else if(i(t))n(t,a,o);else{var l=document.createElement("a");l.href=t,l.target="_blank",setTimeout(function(){s(l)})}}:function(t,e,a,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof t)return n(t,e,a);var s="application/octet-stream"===t.type,l=/constructor/i.test(o.HTMLElement)||o.safari,r=/CriOS\/[\d]+/.test(navigator.userAgent);if((r||s&&l)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var t=c.result;t=r?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=t:location=t,i=null},c.readAsDataURL(t)}else{var u=o.URL||o.webkitURL,p=u.createObjectURL(t);i?i.location=p:location.href=p,i=null,setTimeout(function(){u.revokeObjectURL(p)},4e4)}});o.saveAs=l.saveAs=l,t.exports=l})}).call(this,a("c8ba"))},"6ba1":function(t,e,a){"use strict";var n=a("9e4d"),i=a.n(n);i.a},"79ba":function(t,e,a){"use strict";a.d(e,"b",function(){return n}),a.d(e,"c",function(){return i}),a.d(e,"a",function(){return s});const n=["待支付","待发货","配送中","待评价","已完成","已取消","配货中"],i=[{name:"今",value:0},{name:"昨",value:1},{name:"近7天",value:7},{name:"近30天",value:30}],s=[{id:1,name:"待对账"},{id:2,name:"对账中"},{id:3,name:"已完成"}]},"84fb":function(t,e,a){},8831:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("page-title",{attrs:{"first-title":"账户信息"}}),a("suppliers-base-info",{attrs:{suppliersInfo:t.suppliers_info,suppliersId:t.suppliers_id}}),a("section",[a("div",{staticClass:"account-detail clearfix"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("account-detail-item",{attrs:{title:"账户余额",needWithDrawal:t.isPlatformRole,cash:t.account.cash_money,huanbi:t.account.huanbi_money},on:{"show-desc":function(e){return t.showDesc("account")},"go-detail":function(e){return t.goDetail("account")},"go-with-draw":t.goWithdraw}})],1),a("el-col",{attrs:{span:6}},[a("account-detail-item",{attrs:{title:"待结算金额",cash:t.account.wait_statement_cash,huanbi:t.account.wait_statement_huanbi},on:{"show-desc":function(e){return t.showDesc("waitmoney")},"go-detail":function(e){return t.goDetail("waitmoney")}}})],1),a("el-col",{attrs:{span:6}},[a("account-detail-item",{attrs:{title:"交易中的金额","show-detail":!1,cash:t.account.trade_statement_cash,huanbi:t.account.trade_statement_huanbi},on:{"show-desc":function(e){return t.showDesc("salemoney")}}})],1),a("el-col",{attrs:{span:6}},[a("account-detail-item",{attrs:{title:"保证金","show-desc":!1,single:!0,amount:t.account.bond_money},on:{"go-detail":function(e){return t.goDetail("bond")}}})],1)],1),1==t.cooperateType?a("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("account-detail-item",{attrs:{title:"消费积分账户","show-detail":!1,"show-desc":!1,single:!0,amount:t.account.huanbi_withdraw}})],1)],1):t._e()],1)]),a("div",{staticClass:"search-wrapper"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"日账单编号"}},[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"请输入日账单编号",clearable:""},model:{value:t.params.statement_no,callback:function(e){t.$set(t.params,"statement_no",e)},expression:"params.statement_no"}})],1),a("el-form-item",{attrs:{label:"生成日期"}},[a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date",placeholder:"选择开始日期","value-format":"timestamp"},model:{value:t.params.addtime,callback:function(e){t.$set(t.params,"addtime",e)},expression:"params.addtime"}}),t._v("\n        -\n        "),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date",placeholder:"选择截至日期","value-format":"timestamp"},model:{value:t.params.endtime,callback:function(e){t.$set(t.params,"endtime",e)},expression:"params.endtime"}}),a("div",{staticClass:"radio-wrapper"},[a("el-radio-group",{attrs:{size:"small"},on:{change:t.selecttime},model:{value:t.timeselect,callback:function(e){t.timeselect=e},expression:"timeselect"}},t._l(t.timelist,function(e,n){return a("el-radio-button",{key:n,attrs:{label:e.value}},[t._v(t._s(e.name))])}),1)],1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticStyle:{width:"140px"},attrs:{clearable:""},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.statusList,function(t){return a("el-option",{key:t.id,attrs:{value:t.id,label:t.name}})}),1)],1)],1),a("div",[a("el-button",{attrs:{type:"primary"},on:{click:t.search}},[t._v("搜索")]),a("el-button",{on:{click:t.clear}},[t._v("清空")])],1)],1),a("div",{staticClass:"list-wrapper"},[a("div",{staticClass:"btn-box"},[t.isSettle?t._e():a("el-button",{attrs:{type:"primary"},on:{click:t.exportList}},[t._v("导出账单详情")]),t.isSettle?a("el-button",{staticStyle:{"background-color":"#13ce66",color:"#fff"},attrs:{disabled:2==t.suppliers_info.create_multi_method},on:{click:t.exportPay}},[t._v("生成对账单")]):t._e(),t.isPlatformRole?a("el-switch",{staticStyle:{padding:"0 20px"},attrs:{"active-color":"#13ce66","inactive-color":"#409eff"},model:{value:t.isSettle,callback:function(e){t.isSettle=e},expression:"isSettle"}}):t._e(),t.isPlatformRole&&t.isSettle?a("span",[t._v("切换导出账单")]):t.isPlatformRole&&!t.isSettle?a("span",[t._v("切换生成对账单")]):t._e()],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.isLoading,expression:"isLoading"}],ref:"statementList",staticStyle:{width:"100%"},attrs:{data:t.list,border:"",stripe:"","header-cell-style":{background:"#eef1f6"}},on:{select:t.handleSelection,"select-all":t.selectAll}},[[a("el-table-column",{key:"multi",attrs:{type:"selection",selectable:t.filterSelect}})],a("el-table-column",{attrs:{prop:"statement_no",label:"日账单编号"}}),a("el-table-column",{attrs:{prop:"addtime",label:"日账单生成日期",formatter:t.dateFormat}}),a("el-table-column",{attrs:{prop:"add_cash",label:"现金收入（元）"}}),1==t.cooperateType?a("el-table-column",{attrs:{prop:"add_huanbi",label:"积分收入（个）"}}):t._e(),a("el-table-column",{attrs:{prop:"sub_cash",label:"现金支出（元）"}}),1==t.cooperateType?a("el-table-column",{attrs:{prop:"sub_huanbi",label:"积分支出（个）"}}):t._e(),a("el-table-column",{attrs:{prop:"cash",label:"现金结算（元）"}}),1==t.cooperateType?a("el-table-column",{attrs:{prop:"huanbi",label:"积分结算（个）"}}):t._e(),a("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.statusFormat}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.viewDetail(e.row.suppliers_statement_id)}}},[t._v("查看")])]}}])})],2)],1),a("el-pagination",{attrs:{background:"","current-page":t.params.page,layout:"prev, pager, next, jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.params,"page",e)},"update:current-page":function(e){return t.$set(t.params,"page",e)}}})],1)},i=[],s=(a("ac6a"),a("097d"),a("6b54"),a("be94")),o=a("afbd"),l=a("9d62"),r=a("2f62"),c=a("7ee9"),u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account-detail-container"},[a("div",{staticClass:"first-row"},[a("div",{staticClass:"title-box"},[a("span",{staticClass:"title"},[t._v(t._s(t.title))]),t.showDesc?a("span",{staticClass:"desc",on:{click:t.goDesc}},[t._v("?")]):t._e(),t.showDetail?a("span",{staticClass:"detail",on:{click:t.goDetail}},[t._v("明细")]):t._e()])]),t.single?a("div",{staticClass:"second-row"},[a("div",{staticClass:"money-num"},[t._v(t._s(t.amount))])]):a("div",{staticClass:"second-row"},[a("div",{staticClass:"left-box"},[a("div",{staticClass:"money-name"},[t._v("现金余额（元）")]),a("div",{staticClass:"money-num"},[t._v(t._s(t.cash))])]),1==t.cooperateType?a("div",{staticClass:"right-box"},[a("div",{staticClass:"money-name"},[t._v("积分余额（个）")]),a("div",{staticClass:"money-num"},[t._v(t._s(t.huanbi))]),t.needWithDrawal&&1==t.cooperateType?a("div",{staticClass:"withdrawal",on:{click:t.goWithDrawal}},[t._v("提现消费")]):t._e()]):t._e()])])},p=[],d={name:"",props:{title:null,showDesc:{type:Boolean,default:!0},showDetail:{type:Boolean,default:!0},single:{type:Boolean,default:!1},needWithDrawal:{type:Boolean,default:!1},amount:null,cash:null,huanbi:null},data(){return{}},computed:Object(s["a"])({},Object(r["c"])({cooperateType:t=>t.suppliers.cooperateType})),created(){},methods:{goDesc(){this.$emit("show-desc")},goDetail(){this.$emit("go-detail")},goWithDrawal(){this.$emit("go-with-draw")}}},m=d,f=(a("a1c8"),a("2877")),h=Object(f["a"])(m,u,p,!1,null,"078703a3",null),b=h.exports,v=(a("ff03"),a("21a6")),g=a("79ba"),_={name:"SuppliersAccount",data(){return{statusList:g["a"],timelist:g["c"],timeselect:"",params:{suppliers_id:"",statement_no:"",addtime:"",endtime:"",status:"",page:1,size:10},total:0,list:[],suppliers_info:{suppliers_name:"",shop_name:"",manager_name:"",manager_tel:""},account:{},isLoading:!1,selectObj:{},isSettle:!1}},components:{SuppliersBaseInfo:c["a"],AccountDetailItem:b},created(){this.getInfo(),this.getStateList(),this.getRoles()},computed:Object(s["a"])({},Object(r["c"])({suppliers_id:t=>t.suppliers.suppliers_id,role:t=>t.settle.role,cooperateType:t=>t.suppliers.cooperateType}),{isPlatformRole(){return"all"===this.role||"operater"===this.role},isSupplierRole(){return"supplier"===this.role},fmtParams(){let t=JSON.parse(JSON.stringify(this.params));return t.addtime.toString().length>10&&(t.addtime=parseInt(t.addtime/1e3)),t.endtime.toString().length>10&&(t.endtime=parseInt(t.endtime/1e3)),t.suppliers_id=this.suppliers_id,t}}),methods:Object(s["a"])({},Object(r["b"])({setSupplierName:"setSupplierName",saveRole:"saveRole",saveCooperateType:"saveCooperateType",saveStatementIdList:"saveStatementIdList",saveStatementPreview:"saveStatementPreview"}),{getRoles(){Object(l["o"])().then(t=>{this.saveRole(t.role)})},getInfo(){Object(o["e"])(this.suppliers_id).then(t=>{this.account=t}),Object(o["g"])(this.suppliers_id).then(t=>{this.suppliers_info=t,this.setSupplierName(t.suppliers_name),this.saveCooperateType(t.cooperate_type)})},getStateList(){this.isLoading=!0,Object(o["m"])(this.fmtParams).then(t=>{this.list=t.list,this.total=t.paged.total}).finally(()=>{this.isLoading=!1})},viewDetail(t){this.$router.push({name:"SuppliersStatementInfo",params:{id:t}})},showDesc(t){let e="";"account"==t?e="现金余额：生成结算单后金额打入该账户，财务打款后金额从该账号扣除。<br>积分余额：生成结算单后积分打入该账号":"waitmoney"==t?e="已确认收货未生成对账单的订单合计":"salemoney"==t&&(e="已付款未确认收货前的订单合计"),this.$alert(e,"",{dangerouslyUseHTMLString:!0})},goDetail(t){let e="";"account"==t?e="accountBalance":"waitmoney"==t?e="unsettledDetail":"bond"==t&&(e="BondInfo"),this.$router.push({name:e})},goWithdraw(){this.$router.push({name:"SurplusWithdrawal"})},selecttime(t){let e,a=(new Date).getTime(),n=new Date((new Date).toLocaleDateString()).getTime(),i=new Date((new Date).toLocaleDateString()).getTime()-864e5,s=new Date((new Date).toLocaleDateString()).getTime()-6048e5,o=new Date((new Date).toLocaleDateString()).getTime()-2592e6,l=a;t?1===t?(e=i,l=n-1):7===t?e=s:30===t&&(e=o):e=n,this.params.addtime=e,this.params.endtime=l,this.getStateList()},search(){this.params.page=1,this.getStateList()},clear(){this.timeselect="";for(let t in this.params)this.params[t]="";this.params.page=1,this.params.size=10,this.getStateList()},handleCurrentChange(){this.getStateList()},dateFormat:function(t,e){let a=t[e.property];return this.utils.formatDate("YYYY-MM-DD HH:mm:ss",1e3*a)},statusFormat(t,e,a){let n="";return this.statusList.forEach(t=>{t.id==a&&(n=t.name)}),n},handleSelection(t,e){this.selectObj[e.suppliers_statement_id]?this.changeSelectState([e],!1):this.changeSelectState([e],!0)},selectAll(t){t.length?this.changeSelectState(t,!0):this.changeSelectState(this.list,!1)},changeSelectState(t,e){const a=Object(s["a"])({},this.selectObj);e?t.forEach(t=>{a[t.suppliers_statement_id]=t}):t.forEach(t=>{delete a[t.suppliers_statement_id]}),this.selectObj=Object(s["a"])({},a)},filterSelect(t){if(this.isSettle){let e=!(t.status>1);return e}return!0},exportList(){let t=[...Object.keys(this.selectObj)];t.length&&Object(o["c"])({suppliers_id:this.suppliers_id,suppliers_statement_id:t}).then(t=>{const e=this.utils.formatDate("YYYY-MM-DD",(new Date).getTime());Object(v["saveAs"])(new Blob([t.data]),t.filename||this.suppliers_info.suppliers_name+e+"结算单.xls")},t=>{console.log(t)})},exportPay(){let t=[...Object.keys(this.selectObj)];t=t.map(t=>Number(t)),this.saveStatementIdList(t),t.length&&Object(o["q"])(this.suppliers_id,t).then(t=>{t.all_cash=t.all_cash>0?t.all_cash:0,t.all_huanbi=t.all_huanbi>0?t.all_huanbi:0,this.saveStatementPreview(t),this.$router.push({name:"SettlementAdd"})},t=>{console.log(t)})}})},w=_,S=(a("6ba1"),Object(f["a"])(w,n,i,!1,null,"73a56ae4",null));e["default"]=S.exports},"9d62":function(t,e,a){"use strict";a.d(e,"n",function(){return s}),a.d(e,"v",function(){return o}),a.d(e,"d",function(){return l}),a.d(e,"x",function(){return r}),a.d(e,"o",function(){return c}),a.d(e,"r",function(){return u}),a.d(e,"b",function(){return p}),a.d(e,"q",function(){return d}),a.d(e,"c",function(){return m}),a.d(e,"a",function(){return f}),a.d(e,"f",function(){return h}),a.d(e,"m",function(){return b}),a.d(e,"i",function(){return v}),a.d(e,"j",function(){return g}),a.d(e,"p",function(){return _}),a.d(e,"l",function(){return w}),a.d(e,"e",function(){return S}),a.d(e,"w",function(){return O}),a.d(e,"s",function(){return y}),a.d(e,"h",function(){return j}),a.d(e,"t",function(){return T}),a.d(e,"g",function(){return D}),a.d(e,"k",function(){return P}),a.d(e,"u",function(){return k});var n=a("be94"),i=a("65c6");const s=t=>Object(i["a"])("/admin/api.remit.settings.get","POST",{suppliers_id:t}),o=t=>Object(i["a"])("/admin/api.remit.settings.set","POST",Object(n["a"])({},t)),l=t=>Object(i["a"])("/admin/api.multi.statement.create","POST",Object(n["a"])({},t)),r=t=>Object(i["a"])("/admin/api.multi.statement.update","POST",Object(n["a"])({},t)),c=()=>Object(i["a"])("/admin/api.suppliers.role.get","POST",{}),u=t=>Object(i["a"])("/admin/api.multi.statement.get","POST",{multi_statement_id:t}),p=(t,e)=>Object(i["a"])("/admin/api.multi.statement.remit","POST",{multi_statement_id:t,remit_log:e}),d=t=>Object(i["a"])("/admin/api.multi.statement.list.get","POST",Object(n["a"])({},t)),m=t=>Object(i["a"])("/admin/api.multi.statement.suppliers.confirm","POST",Object(n["a"])({},t)),f=(t,e,a,n)=>Object(i["a"])("/admin/api.suppliers.bond.reduce","POST",{suppliers_id:t,bond:e,direction:a,remark:n}),h=t=>Object(i["b"])("/admin/api.multi.statement.print","POST",{multi_statement_id:t}),b=function(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return Object(i["a"])("/admin/api.suppliers.bond.list","POST",{suppliers_id:t,page:e,size:a})},v=t=>Object(i["a"])("/admin/api.suppliers.account.log.list","POST",t),g=t=>Object(i["a"])("/admin/api.suppliers.statement.income.list","POST",t),_=t=>Object(i["a"])("/admin/api.multi.statement.orders","POST",t),w=t=>Object(i["a"])("/admin/api.suppliers.payment.list","POST",t),S=t=>Object(i["b"])("/admin/api.multi.statement.export","POST",t),O=t=>Object(i["a"])("/admin/api.suppliers.payment.upload","POST",t),y=t=>Object(i["a"])("/admin/api.multi.statement.suppliers.rollback","POST",t),j=t=>Object(i["a"])("/admin/api.multi.statement.finance.rollback","POST",t),T=t=>Object(i["a"])("/admin/api.multi.statement.operater.confirm","POST",t),D=t=>Object(i["a"])("/admin/api.multi.statement.finance.confirm","POST",t),P=t=>Object(i["a"])("/admin/api.multi.statement.action","POST",t),k=t=>Object(i["b"])("/admin/api.multi.statement.print","POST",t)},"9e4d":function(t,e,a){},a1c8:function(t,e,a){"use strict";var n=a("84fb"),i=a.n(n);i.a},a5b8:function(t,e,a){"use strict";var n=a("d8e8");function i(t){var e,a;this.promise=new t(function(t,n){if(void 0!==e||void 0!==a)throw TypeError("Bad Promise constructor");e=t,a=n}),this.resolve=n(e),this.reject=n(a)}t.exports.f=function(t){return new i(t)}},bcaa:function(t,e,a){var n=a("cb7c"),i=a("d3f4"),s=a("a5b8");t.exports=function(t,e){if(n(t),i(e)&&e.constructor===t)return e;var a=s.f(t),o=a.resolve;return o(e),a.promise}}}]);
//# sourceMappingURL=chunk-1d15d187.e218edd8.js.map