(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6d7f8ad9"],{"097d":function(e,t,a){"use strict";var s=a("5ca1"),n=a("8378"),i=a("7726"),l=a("ebd6"),r=a("bcaa");s(s.P+s.R,"Promise",{finally:function(e){var t=l(this,n.Promise||i.Promise),a="function"==typeof e;return this.then(a?function(a){return r(t,e()).then(function(){return a})}:e,a?function(a){return r(t,e()).then(function(){throw a})}:e)}})},"18bd":function(e,t,a){},"21a6":function(e,t,a){(function(a){var s,n,i;(function(a,l){n=[],s=l,i="function"===typeof s?s.apply(t,n):s,void 0===i||(e.exports=i)})(0,function(){"use strict";function t(e,t){return"undefined"==typeof t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function s(e,t,a){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){r(s.response,t,a)},s.onerror=function(){console.error("could not download file")},s.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(s){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,r=l.saveAs||("object"!=typeof window||window!==l?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,a){var r=l.URL||l.webkitURL,o=document.createElement("a");t=t||e.name||"download",o.download=t,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?i(o):n(o.href)?s(e,t,a):i(o,o.target="_blank")):(o.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(o.href)},4e4),setTimeout(function(){i(o)},0))}:"msSaveOrOpenBlob"in navigator?function(e,a,l){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,l),a);else if(n(e))s(e,a,l);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){i(r)})}}:function(e,t,a,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof e)return s(e,t,a);var i="application/octet-stream"===e.type,r=/constructor/i.test(l.HTMLElement)||l.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||i&&r)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=o?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=e:location=e,n=null},c.readAsDataURL(e)}else{var u=l.URL||l.webkitURL,p=u.createObjectURL(e);n?n.location=p:location.href=p,n=null,setTimeout(function(){u.revokeObjectURL(p)},4e4)}});l.saveAs=r.saveAs=r,e.exports=r})}).call(this,a("c8ba"))},"79ba":function(e,t,a){"use strict";a.d(t,"b",function(){return s}),a.d(t,"c",function(){return n}),a.d(t,"a",function(){return i});const s=["待支付","待发货","配送中","待评价","已完成","已取消","配货中"],n=[{name:"今",value:0},{name:"昨",value:1},{name:"近7天",value:7},{name:"近30天",value:30}],i=[{id:1,name:"待对账"},{id:2,name:"对账中"},{id:3,name:"已完成"}]},8691:function(e,t,a){"use strict";var s=a("18bd"),n=a.n(s);n.a},a5b8:function(e,t,a){"use strict";var s=a("d8e8");function n(e){var t,a;this.promise=new e(function(e,s){if(void 0!==t||void 0!==a)throw TypeError("Bad Promise constructor");t=e,a=s}),this.resolve=s(t),this.reject=s(a)}e.exports.f=function(e){return new n(e)}},bcaa:function(e,t,a){var s=a("cb7c"),n=a("d3f4"),i=a("a5b8");e.exports=function(e,t){if(s(e),n(t)&&t.constructor===e)return t;var a=i.f(e),l=a.resolve;return l(t),a.promise}},d7dd:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("page-title",{attrs:{"first-title":"账户信息"}}),a("suppliers-base-info",{attrs:{suppliersInfo:e.suppliers_info,suppliersId:e.suppliers_id}}),a("div",{staticClass:"search-wrapper"},[a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.searchParams}},[a("el-form-item",{attrs:{label:"结算单编号："}},[a("el-input",{staticStyle:{width:"200px"},model:{value:e.searchParams.statement_no,callback:function(t){e.$set(e.searchParams,"statement_no",t)},expression:"searchParams.statement_no"}})],1),a("el-form-item",{attrs:{label:"生成日期："}},[a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date",placeholder:"选择开始日期"},model:{value:e.addtime,callback:function(t){e.addtime=t},expression:"addtime"}}),e._v("\n        -\n        "),a("el-date-picker",{staticStyle:{width:"150px"},attrs:{type:"date",placeholder:"选择截至日期"},model:{value:e.endtime,callback:function(t){e.endtime=t},expression:"endtime"}}),a("div",{staticClass:"radio-wrapper"},[a("el-radio-group",{attrs:{size:"small"},on:{change:e.selecttime},model:{value:e.timeselect,callback:function(t){e.timeselect=t},expression:"timeselect"}},e._l(e.timelist,function(t,s){return a("el-radio-button",{key:s,attrs:{label:t.value}},[e._v(e._s(t.name))])}),1)],1)],1),a("div",{staticClass:"cuttline"}),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.search}},[e._v("搜索")]),a("el-button",{on:{click:e.clear}},[e._v("清空")]),e.isSettle?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.exportList}},[e._v("导出账单详情")]),"all"===e.role||"operater"===e.role?[e.isSettle?a("el-button",{on:{click:e.exportPay}},[e._v("生成付款清单")]):e._e(),a("el-switch",{staticStyle:{padding:"0 20px"},model:{value:e.isSettle,callback:function(t){e.isSettle=t},expression:"isSettle"}}),e.isSettle?a("span",[e._v("切换导出账单")]):a("span",[e._v("切换生成付款清单")])]:e._e()],2)],1)],1),a("div",{staticClass:"list-wrapper"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.isLoading,expression:"isLoading"}],ref:"statementList",staticStyle:{width:"100%"},attrs:{data:e.list,"header-cell-style":{background:"#eef1f6"}},on:{select:e.handleSelection,"select-all":e.selectAll}},[e.suppliers_id?[e.checkboxStatus?a("el-table-column",{key:"single",attrs:{type:"selection",selectable:e.checkboxFilter}}):a("el-table-column",{key:"multi",attrs:{type:"selection",selectable:e.filterSelect}})]:[a("el-table-column",{attrs:{type:"selection"}})],a("el-table-column",{attrs:{prop:"statement_no",label:"结算单编号"}}),a("el-table-column",{attrs:{prop:"addtime",label:"结算生成日期",formatter:e.dateFormat}}),a("el-table-column",{attrs:{prop:"add_cash",label:"现金收入（元）"}}),1==e.cooperateType?a("el-table-column",{attrs:{prop:"add_huanbi",label:"积分收入（个）","class-name":"dark"}}):e._e(),a("el-table-column",{attrs:{prop:"sub_cash",label:"现金支出（元）"}}),1==e.cooperateType?a("el-table-column",{attrs:{prop:"sub_huanbi",label:"积分支出（个）","class-name":"dark"}}):e._e(),a("el-table-column",{attrs:{prop:"cash",label:"现金结算（元）"}}),1==e.cooperateType?a("el-table-column",{attrs:{prop:"huanbi",label:"积分结算（个）","class-name":"dark"}}):e._e(),a("el-table-column",{attrs:{prop:"status",label:"状态",formatter:e.statusFormat}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.viewDetail(t.row.suppliers_statement_id)}}},[e._v("查看")])]}}])})],2)],1),a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.searchParams.size,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange}})],1)},n=[],i=(a("ac6a"),a("097d"),a("be94")),l=a("afbd"),r=a("2f62"),o=a("21a6"),c=a("79ba"),u=a("7ee9"),p={name:"SuppliersStatementList",data(){return{checkboxStatus:!1,isSettle:!1,statementIds:[],total:0,currentPage:1,addtime:"",endtime:"",searchParams:{type:1,suppliers_id:"",size:10,page:1,addtime:"",endtime:"",statement_no:""},list:[],suppliers_info:{suppliers_name:"",shop_name:"",manager_name:"",manager_tel:""},selectObj:{},statementStatus:{1:"未结算",2:"待结算",3:"已结算"},timelist:c["c"],timeselect:"",isLoading:!1}},components:{SuppliersBaseInfo:u["a"]},created(){this.getInfo(),this.getStateList()},computed:Object(i["a"])({},Object(r["c"])({suppliers_id:e=>e.suppliers.suppliers_id,role:e=>e.settle.role,cooperateType:e=>e.suppliers.cooperateType})),watch:{checkboxStatus(){this.$refs.statementList.clearSelection(),this.selectObj={}}},methods:Object(i["a"])({},Object(r["b"])({saveStatementPreview:"saveStatementPreview",saveStatementIdList:"saveStatementIdList"}),{getInfo(){Object(l["g"])(this.suppliers_id).then(e=>{this.suppliers_info=e})},getStateList(){this.isLoading=!0,this.searchParams.addtime=parseInt(this.addtime/1e3),this.searchParams.endtime=parseInt(this.endtime/1e3),this.searchParams.suppliers_id=this.suppliers_id,Object(l["m"])(this.searchParams).then(e=>{this.list=e.list,this.total=e.paged.total},e=>{console.log(e)}).finally(()=>{this.isLoading=!1})},viewDetail(e){this.$router.push({name:"SuppliersStatementInfo",params:{id:e}})},handleCurrentChange(e){this.searchParams.page=e,this.getStateList()},dateFormat:function(e,t){let a=e[t.property];return this.utils.formatDate("YYYY-MM-DD HH:mm:ss",1e3*a)},selecttime(e){let t,a=(new Date).getTime(),s=new Date((new Date).toLocaleDateString()).getTime(),n=new Date((new Date).toLocaleDateString()).getTime()-864e5,i=new Date((new Date).toLocaleDateString()).getTime()-6048e5,l=new Date((new Date).toLocaleDateString()).getTime()-2592e6,r=a;e?1===e?(t=n,r=s-1):7===e?t=i:30===e&&(t=l):t=s,this.addtime=t,this.endtime=r,this.getStateList()},clear(){this.searchParams.statement_no="",this.addtime="",this.endtime="",this.timeselect="",this.getStateList()},search(){this.searchParams.page=1,this.getStateList()},handleSelection(e,t){this.selectObj[t.suppliers_statement_id]?this.changeSelectState([t],!1):this.changeSelectState([t],!0)},selectAll(e){e.length?this.changeSelectState(e,!0):this.changeSelectState(this.list,!1)},changeSelectState(e,t){const a=Object(i["a"])({},this.selectObj);t?e.forEach(e=>{a[e.suppliers_statement_id]=e}):e.forEach(e=>{delete a[e.suppliers_statement_id]}),this.selectObj=Object(i["a"])({},a)},exportList(){let e=[...Object.keys(this.selectObj)];e.length&&Object(l["c"])({suppliers_id:this.suppliers_id,suppliers_statement_id:e}).then(e=>{const t=this.utils.formatDate("YYYY-MM-DD",(new Date).getTime());Object(o["saveAs"])(new Blob([e.data]),e.filename||this.suppliers_info.suppliers_name+t+"结算单.xls")},e=>{console.log(e)})},exportPay(){let e=[...Object.keys(this.selectObj)];e=e.map(e=>Number(e)),this.saveStatementIdList(e),e.length&&Object(l["q"])(this.suppliers_id,e).then(e=>{e.all_cash=e.all_cash>0?e.all_cash:0,e.all_huanbi=e.all_huanbi>0?e.all_huanbi:0,this.saveStatementPreview(e),this.$router.push({name:"SettlementAdd"})},e=>{console.log(e)})},checkboxFilter(e){var t=1!=e.status;return t},navToMultiForm(){var e=[...Object.keys(this.selectObj)];e.length&&this.$router.push({name:"MultiSuppliersStatementForm",params:{statements:this.selectObj,type:"create"}})},statusFormat(e,t){let a=e[t.property];return this.statementStatus[a]},filterSelect(e){if(this.isSettle){let t=!(e.status>1);return t}return!0}})},d=p,m=(a("8691"),a("2877")),h=Object(m["a"])(d,s,n,!1,null,"14b4a154",null);t["default"]=h.exports}}]);
//# sourceMappingURL=chunk-6d7f8ad9.f0969a7a.js.map