(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22c3e324"],{"2e31":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("page-title",{attrs:{"first-title":"发布报名"}}),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.AddNewtheme=!0}}},[e._v("去发布")])],1),a("div",{staticClass:"search-wrapper"},[a("el-form",{attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"报名主题："}},[a("el-input",{attrs:{placeholder:"报名主题",clearable:""},model:{value:e.params.secName,callback:function(t){e.$set(e.params,"secName",t)},expression:"params.secName"}})],1),a("el-form-item",[a("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.getList}},[e._v("\n          搜索\n        ")]),a("el-button",{on:{click:e.clear}},[e._v("\n          清空\n        ")])],1)],1)],1),a("div",{staticClass:"list-wrapper"},[a("el-table",{attrs:{data:e.list,stripe:"",width:"100%","header-cell-style":{background:"#eef1f6"}}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),a("el-table-column",{attrs:{prop:"secName",label:"报名主题"}}),a("el-table-column",{attrs:{label:"支持类目",prop:"categoryId"}}),a("el-table-column",{attrs:{prop:"createdAt",label:"发布时间",formatter:e.timeStampFmt}}),a("el-table-column",{attrs:{prop:"startTime",label:"报名时间",formatter:e.timeStampFmt}}),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间",formatter:e.timeStampFmt}}),a("el-table-column",{attrs:{prop:"signUpStatusStr",label:"报名状态"}}),a("el-table-column",{attrs:{label:"操作","min-width":"200px"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.signUpStatus||1===t.row.signUpStatus?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.goEdit(t.row)}}},[e._v("编辑")]):e._e(),0===t.row.signUpStatus?a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.goRemove(t.row.id)}}},[e._v("移除")]):e._e()]}}])})],1)],1),a("el-pagination",{attrs:{"current-page":e.currentPage,background:"",layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}}),a("el-dialog",{attrs:{title:"秒杀报名活动编辑",visible:e.editheme},on:{"update:visible":function(t){e.editheme=t}}},[a("div",{staticClass:"edit"},[a("el-form",{attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"报名主题："}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.secName,callback:function(t){e.$set(e.form,"secName",t)},expression:"form.secName"}})],1),a("el-form-item",{attrs:{label:"支持类目："}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.categoryId,callback:function(t){e.$set(e.form,"categoryId",t)},expression:"form.categoryId"}})],1),a("el-form-item",{attrs:{label:"报名时间："}},[a("el-col",{attrs:{span:11}},[a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",disabled:""},model:{value:1e3*e.form.startTime,callback:function(t){e.$set(e.form,"startTime * 1000",t)},expression:"form.startTime * 1000"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[e._v("至")]),a("el-col",{attrs:{span:11}},[a("el-form-item",[a("el-date-picker",{attrs:{type:"datetime",disabled:""},model:{value:1e3*e.form.endTime,callback:function(t){e.$set(e.form,"endTime * 1000",t)},expression:"form.endTime * 1000"}})],1)],1)],1),a("el-form-item",{attrs:{label:"主题说明："}},[a("el-input",{attrs:{type:"textarea",rows:"4","show-word-limit":"",maxlength:"300"},model:{value:e.form.secDesc,callback:function(t){e.$set(e.form,"secDesc",t)},expression:"form.secDesc"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editheme=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.submitEdit}},[e._v("确 定")])],1)]),a("el-dialog",{attrs:{title:"发布报名",visible:e.AddNewtheme},on:{"update:visible":function(t){e.AddNewtheme=t}}},[a("div",{staticClass:"edit"},[a("el-form",{ref:"Newtheme",attrs:{model:e.Newtheme,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"报名主题：",prop:"secName"}},[a("el-input",{attrs:{maxlength:"30"},model:{value:e.Newtheme.secName,callback:function(t){e.$set(e.Newtheme,"secName",t)},expression:"Newtheme.secName"}})],1),a("el-form-item",{attrs:{label:"支持类目：",prop:"categoryId"}},[a("el-select",{staticStyle:{display:"block"},attrs:{multiple:"",filterable:"",clearable:"",placeholder:"请选择"},on:{change:e.selected},model:{value:e.Newtheme.categoryId,callback:function(t){e.$set(e.Newtheme,"categoryId",t)},expression:"Newtheme.categoryId"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),a("el-form-item",{attrs:{label:"报名时间：",required:""}},[a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"startTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",placeholder:"年-月-日 时:分",format:"yyyy-MM-dd HH:mm","value-format":"timestamp","picker-options":e.pickerOptions0},model:{value:e.Newtheme.startTime,callback:function(t){e.$set(e.Newtheme,"startTime",t)},expression:"Newtheme.startTime"}})],1)],1),a("el-col",{staticClass:"line",staticStyle:{"text-align":"center"},attrs:{span:2}},[e._v("-")]),a("el-col",{attrs:{span:11}},[a("el-form-item",{attrs:{prop:"endTime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"timestamp",placeholder:"年-月-日 时:分",format:"yyyy-MM-dd HH:mm","picker-options":e.pickerOptions1,"default-time":"23:59:59"},on:{change:e.formatendtime},model:{value:e.Newtheme.endTime,callback:function(t){e.$set(e.Newtheme,"endTime",t)},expression:"Newtheme.endTime"}})],1)],1)],1),a("el-form-item",{attrs:{label:"主题说明：",prop:"type"}},[a("el-input",{attrs:{type:"textarea",rows:"4",maxlength:"300",placeholder:"300字符以内","show-word-limit":""},model:{value:e.Newtheme.secDesc,callback:function(t){e.$set(e.Newtheme,"secDesc",t)},expression:"Newtheme.secDesc"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitAdd("Newtheme")}}},[e._v("发 布")])],1)])],1)},i=[],l={name:"addNewEnroll",data(){return{pickerOptions0:{disabledDate:e=>{return""!=this.Newtheme.endTime&&null!=this.Newtheme.endTime?e.getTime()<Date.now()-864e5||e>this.Newtheme.endTime:e.getTime()<Date.now()-864e5}},pickerOptions1:{disabledDate:e=>{return e<this.Newtheme.startTime-864e5}},params:{page:1,limit:10,secName:"",type:"2"},currentPage:1,total:0,list:[],loading:null,editheme:!1,AddNewtheme:!1,form:{},Newtheme:{secName:"",categoryId:"",startTime:"",endTime:"",secDesc:""},options:[{value:"1",label:"黄金糕"}],rules:{secName:[{required:!0,message:"请输入活动名称",trigger:"blur"},{min:1,max:30,message:"长度在 1 到 30 个字符",trigger:"blur"}],categoryId:[{required:!0,message:"支持类目",trigger:"change"}],startTime:[{type:"date",required:!0,message:"请选择开始时间",trigger:"change"}],endTime:[{type:"date",required:!0,message:"请选择结束时间",trigger:"change"}],secDesc:[{required:!0,message:"请填写活动形式",trigger:"blur"}]},allowable:!0,id:""}},created(){this.getList(),this.gettypeList()},methods:{getList(){this.loading=!0,this.$api.get("hd/itzSecbuySignup/signup",this.params,e=>{console.log(e),200==e.status?(this.list=e.data.itzSecbuySignupVoList,this.total=e.data.total,console.log(this.list)):(this.list={},this.$message.error(e.message))})},gettypeList(){this.$api.get("hd/itzSecbuySignup/categoryList",null,e=>{console.log(e),200==e.status&&(this.options=e.data)})},clear(){this.params.page=1,this.params.theme="",this.params.secName="",this.getList()},goEdit(e){this.editheme=!0,this.id=e.id,this.form=e,console.log(this.form)},handleCurrentChange(){this.params.page=this.currentPage,this.getList()},timeStampFmt(e,t){let a="string"===typeof t?t:t.property,s=e[a];return s?this.utils.formatDate("YYYY-MM-DD HH:mm:ss",this.utils.formatStamp(s,1)):s},formatendtime(e){e&&e<this.Newtheme.startTime&&this.$alert("结束时间不能早于开始时间","提示",{confirmButtonText:"确定",callback:()=>{this.Newtheme.endTime=""}})},submitAdd(e){this.$refs[e].validate(t=>{if(!t||!this.allowable)return this.allowable=!0,console.log("error submit!!"),!1;this.allowable=!1,this.Newtheme.categoryId=this.Newtheme.categoryId.join(","),this.Newtheme.startTime=parseInt(this.Newtheme.startTime/1e3),this.Newtheme.endTime=parseInt(this.Newtheme.endTime/1e3),this.$api.post("hd/itzSecbuySignup/signup",this.Newtheme,t=>{200==t.status&&(this.AddNewtheme=!1,this.Newtheme={},this.$refs[e].resetFields(),this.getList())})})},submitEdit(){console.log(this.form.secDesc),this.$api.put("hd/itzSecbuySignup/signup/".concat(this.id),this.form,e=>{console.log(e),200==e.status?(this.editheme=!1,this.getList()):this.$message({type:"error",message:e.message})})},goRemove(e){this.$confirm("此操作将移除该活动, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$api.delete("hd/itzSecbuySignup/signup/".concat(e),null,e=>{this.$message({type:"success",message:"删除成功!"}),this.getList()})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})},selected(e){console.log(e),this.Newtheme.categoryId}}},r=l,o=(a("6b520"),a("2877")),m=Object(o["a"])(r,s,i,!1,null,"46d9cb60",null);t["default"]=m.exports},"6b520":function(e,t,a){"use strict";var s=a("a859"),i=a.n(s);i.a},a859:function(e,t,a){}}]);
//# sourceMappingURL=chunk-22c3e324.f6ddbe56.js.map